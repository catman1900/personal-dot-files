SV.prototype.VUa=ea(252,function(a){this.J=Jb(arguments,0)});function FW(a,b){return B(a,2,b)}function prc(a,b,c,d,e){return $Ab(a,u(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function GW(a){Yi(this,a,0,-1,null)}w(GW,Xi);function HW(a){Yi(this,a,0,-1,null)}w(HW,Xi);var qrc=[3],rrc=[1],src=[1],trc=[1],urc=[1,2],vrc=[2];function wrc(a){return dc(yoc,function(b){return b.match(a)}).getName()}function xrc(a){Yi(this,a,0,-1,null)}w(xrc,Xi);
xrc.prototype.Lf=function(){return L(this,2)};function yrc(a){Yi(this,a,0,-1,null)}w(yrc,Xi);yrc.prototype.getChartType=function(){return L(this,1)};function zrc(a){Yi(this,a,0,-1,null)}w(zrc,Xi);function Arc(a){Yi(this,a,0,-1,qrc)}w(Arc,Xi);Arc.prototype.getChartType=function(){return L(this,1)};function Brc(a){Yi(this,a,0,-1,rrc)}w(Brc,Xi);function Crc(a){Yi(this,a,0,-1,src)}w(Crc,Xi);function Drc(a){Yi(this,a,0,-1,trc)}w(Drc,Xi);function Erc(a){Yi(this,a,0,-1,urc)}w(Erc,Xi);
var Frc={Mxc:0,pBa:1,MBa:2};function Grc(a){Yi(this,a,0,-1,vrc)}w(Grc,Xi);
var Hrc={Wxc:0,SUM:1,AVERAGE:2,tza:3,xyc:4,fwc:5,MEDIAN:6,COUNT:7,Ivc:8,Jvc:9},Irc={UNKNOWN_ERROR:0,jyc:1,fpc:2,xbc:3},Jrc={Zxc:0,Mbc:1,Efa:2,lk:3,Rxc:4,M3b:5,hdc:6},Krc={Xxc:0,nE:1,lpc:2,Voc:3,zrc:4},Lrc={Sxc:0,hpc:1,OJ:2,Fmc:3},Mrc={Kxc:0,vxc:1,Mfc:2,vwc:3,uwc:4,R6b:5,knc:6},Nrc={xvc:0,QJ:1,UZa:2,rxc:3,juc:4,r2a:5,iyc:6,Oya:7,Mwa:8,rxa:9,HISTOGRAM:10},Orc={UNKNOWN:0,D3b:1,C3b:2,B3b:3,I4b:4,r6b:5,L6b:6,j$b:7,ncc:8,Snc:9,Lrc:10,Urc:11,Kvc:12,Lvc:13,$wc:14,lrc:15};function IW(){A.call(this)}w(IW,A);var Prc=null;IW.prototype.vm=function(){return B(this,1)};function JW(){A.call(this)}w(JW,A);var Qrc=null;JW.prototype.getText=function(){return B(this,1)};JW.prototype.Or=function(){return rc(this,1)};function KW(){A.call(this)}w(KW,A);var Rrc=null;KW.prototype.getStatus=function(){return B(this,1)};KW.prototype.getError=function(){return B(this,9)};function LW(){A.call(this)}w(LW,A);var Src=null;function MW(){A.call(this)}w(MW,A);var Trc=null;
function NW(){A.call(this)}w(NW,A);var Urc=null;NW.prototype.Yaa=function(){return rc(this,1)};NW.prototype.getType=function(){return B(this,3)};NW.prototype.setType=function(a){D(this,3,a)};function OW(){A.call(this)}w(OW,A);var Vrc=null;function PW(){A.call(this)}w(PW,A);var Wrc=null;
IW.prototype.Ra=function(){var a=Prc;a||(Prc=a=yc(IW,{0:{name:"Error",Ob:"ritz.assistant.Error"},1:{name:"message",Oa:9,type:String},2:{name:"code",Oa:14,defaultValue:0,type:Irc},3:{name:"unsupported_op_reason",Oa:14,defaultValue:0,type:Jrc}}));return a};IW.Ra=IW.prototype.Ra;
JW.prototype.Ra=function(){var a=Qrc;a||(Qrc=a=yc(JW,{0:{name:"AnswerQueryPhrase",Ob:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Oa:9,type:String},2:{name:"start_byte",Oa:5,type:Number},3:{name:"num_bytes",Oa:5,type:Number}}));return a};JW.Ra=JW.prototype.Ra;
KW.prototype.Ra=function(){var a=Rrc;a||(Rrc=a=yc(KW,{0:{name:"AnswerResponse",Ob:"ritz.assistant.AnswerResponse"},1:{name:"status",Oa:5,type:Number},10:{name:"parse_status",Oa:14,defaultValue:0,type:Krc},11:{name:"answer_status",Oa:14,defaultValue:0,type:Lrc},2:{name:"formula",Oa:9,type:String},3:{name:"debug_parse_response",Oa:9,type:String},4:{name:"interpretation",Oa:9,type:String},5:{name:"debug_interpretation_response",Oa:9,type:String},6:{name:"unused_phrase",Vc:!0,Oa:11,type:JW},7:{name:"used_entity_phrase",
Vc:!0,Oa:11,type:JW},8:{name:"unused_entity_phrase",Vc:!0,Oa:11,type:JW},9:{name:"error",Oa:11,type:IW},12:{name:"alternate_suggestion",Vc:!0,Oa:11,type:NW},14:{name:"deprecated_formula_builder_used",Oa:9,type:String},15:{name:"answer_visualization_type",Vc:!0,Oa:14,defaultValue:0,type:Nrc},16:{name:"formula_builder_used",Oa:14,defaultValue:0,type:Orc},17:{name:"charting_info",Oa:11,type:MW},18:{name:"answer_field_info",Vc:!0,Oa:11,type:LW},19:{name:"charting_formula",Oa:9,type:String},21:{name:"parse_info",
Vc:!0,Oa:11,type:OW}}));return a};KW.Ra=KW.prototype.Ra;LW.prototype.Ra=function(){var a=Src;a||(Src=a=yc(LW,{0:{name:"AnswerFieldInfo",Ob:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Oa:14,defaultValue:0,type:Mfa},2:{name:"range_ref",Oa:9,type:String}}));return a};LW.Ra=LW.prototype.Ra;
MW.prototype.Ra=function(){var a=Trc;a||(Trc=a=yc(MW,{0:{name:"ChartingInfo",Ob:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Vc:!0,Oa:14,defaultValue:0,type:Nrc},2:{name:"recommended",Oa:8,type:Boolean},3:{name:"user_requested_type",Vc:!0,Oa:14,defaultValue:0,type:Nrc},4:{name:"show_only_chart",Oa:8,type:Boolean}}));return a};MW.Ra=MW.prototype.Ra;
NW.prototype.Ra=function(){var a=Urc;a||(Urc=a=yc(NW,{0:{name:"QuerySuggestion",Ob:"ritz.assistant.QuerySuggestion"},1:{name:"query",Oa:9,type:String},2:{name:"formula",Oa:9,type:String},3:{name:"type",Oa:14,defaultValue:0,type:Mrc},4:{name:"deprecated_formula_builder_used",Oa:9,type:String},5:{name:"formula_builder_used",Oa:14,defaultValue:0,type:Orc}}));return a};NW.Ra=NW.prototype.Ra;
OW.prototype.Ra=function(){var a=Vrc;a||(Vrc=a=yc(OW,{0:{name:"ParseInfo",Ob:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Vc:!0,Oa:11,type:PW}}));return a};OW.Ra=OW.prototype.Ra;PW.prototype.Ra=function(){var a=Wrc;a||(Wrc=a=yc(PW,{0:{name:"IntentInfo",Ob:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Oa:14,defaultValue:0,type:Hrc}}));return a};PW.Ra=PW.prototype.Ra;function QW(a,b,c,d,e,f){G.call(this,a,b);this.C=b;this.qa=c;this.Z=d||null;this.Sa=e||null;this.F=f||null}w(QW,G);QW.prototype.xk=g("qa");QW.prototype.Te=g("Z");function Xrc(a,b,c,d,e,f){QW.call(this,"pe",null,d,e,f);this.J=a;this.L=b;this.xc=c}w(Xrc,QW);Xrc.prototype.Qd=g("xc");function Yrc(a,b,c){QW.call(this,"se",null,2859);this.J=a;this.L=b;this.V=c}w(Yrc,QW);function Zrc(a,b,c,d,e,f,h){P.call(this,h);this.F=a;this.D=b;this.J=e;this.Kb=f;this.C=this.xc=null;this.H=qj(new pj,10).build()}w(Zrc,P);p=Zrc.prototype;p.Wa=function(){Zrc.$.Wa.call(this);(new WU(HE,this.D.tf())).send(u(this.npb,this,this.D))};p.Boa=function(a,b){a=new Xrc(this.F.clone(),this.J,this.xc,2746,a,b);this.dispatchEvent(a)};p.npb=function(a,b){b&&(b.Ci()?gE.tB(this.Ma,b):(b=b.Qd(),a.Zd(b),qV(a,b),hE(a,"ready",u(this.w0b,this,a)),EV(a,this.Ma,this.Kb,Wn),this.xc=b))};
p.w0b=function(a){a.wm()&&(hE(a.wm(),"onmouseover",u(this.u0b,this)),hE(a.wm(),"onmouseout",u(this.v0b,this)))};p.u0b=function(){this.C=Ea()};p.v0b=function(){xa(this.C)&&500<Ea()-this.C&&this.Kb.fc(2750,this.H);this.C=null};function RW(){}w(RW,xK);na(RW);RW.prototype.Ec=n("waffle-assistant-link-button");function $rc(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function asc(a,b){P.call(this,b);this.D=a;this.C=new Ls("",new RW,this.Ba());this.Xa(this.C)}w(asc,P);p=asc.prototype;p.Ia=function(){this.Ma=T($rc)};p.Wa=function(){asc.$.Wa.call(this);var a=this.cb("waffle-assistant-feedback-card-link");this.C.ob(a);this.getHandler().R(this.Ma,"mousedown",this.Pg).R(this.C,"action",this.Trb);this.show(!1)};p.Pg=function(a){a.stopPropagation()};
p.show=function(a){var b=this.Ma,c=this.cb("waffle-assistant-feedback-card-link");tq(b,"waffle-assistant-feedback-card-hidden",!a);on(c,a)};p.Trb=function(){Q.Ey.Dc({source:this.D});this.show(!1);this.dispatchEvent(new G("feedback-dialog-opened"))};function SW(){}w(SW,Js);na(SW);SW.prototype.Ec=n("waffle-assistant-button");function TW(a,b,c,d){a&&(t(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Pa(b),Rs(a,b,d),slc(a),a.setAttribute("data-tooltip-delay",500),WYb(a,t(c)?c:1))};function bsc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(fu({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(fu({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function UW(a){P.call(this,a);this.C=new Ls("",new SW,this.Ba());this.Xa(this.C);this.D=new Ls("",new SW,this.Ba());this.Xa(this.D)}w(UW,P);UW.prototype.Ia=function(){this.Ma=T(bsc)};UW.prototype.Wa=function(){UW.$.Wa.call(this);var a=this.cb("waffle-assistant-thumbs-down-button");this.C.ob(a);TW(a,"Not useful");a=this.cb("waffle-assistant-thumbs-up-button");this.D.ob(a);TW(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function csc(a,b){a.Ba().Df(a.cb("waffle-assistant-thumbs-text"),b)}UW.prototype.F=function(){this.dispatchEvent(new G("thumbs-down"));O(this.Ma,!1)};UW.prototype.H=function(){this.dispatchEvent(new G("thumbs-up"));O(this.Ma,!1)};function dsc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.n7a)+"</span>"),d=0==a.xHa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.xHa;for(var e=a.length,f=0;f<e;f++)var h=a[f],c=c+((f%2?"":'<div class="waffle-assistant-facet-chart-row">')+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(On?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function esc(a,b,c,d,e){P.call(this,e);this.J=a;this.Pa=b;this.Kb=c;this.O=d;this.L=wc(this.J,23);this.Ja=B(this.J,22);this.D=B(this.J,26);this.Ga=[];this.Ee=new Rg;this.V=this.F=this.C=null;this.Z=!1;this.qa=new Ts("",this.Ba());this.Xa(this.qa);this.H=null}w(esc,P);p=esc.prototype;p.Ia=function(){esc.$.Ia.call(this);this.Ma=T(dsc,{n7a:this.D,xHa:this.L});this.Ma.style.visibility="hidden"};
p.Wa=function(){esc.$.Wa.call(this);var a=this.cb("waffle-assistant-facet-toggle");this.qa.ob(a);this.getHandler().R(this.Ma,"mousedown",this.Pg).R(this.qa,"action",this.IEb);On&&(this.V=new asc("assistantAutovisFacetFeedback",this.Ba()),this.V.render(this.cb("waffle-assistant-facet-feedback-container")),this.C=new UW(this.Ba()),this.Xa(this.C),this.C.render(this.cb("waffle-assistant-facet-thumbs-container")),csc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.C,
"thumbs-up",this.t0b).R(this.C,"thumbs-down",this.s0b));fsc(this,Dva)};p.Fd=g("Z");p.hf=function(a){this.Z=a;gsc(this)};p.Pg=function(a){a.stopPropagation()};p.IEb=function(){var a=oq(this.cb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");fsc(this,a);hsc(this,a?2647:2646)};
function fsc(a,b){var c=a.cb("waffle-assistant-facet-toggle");mn(c,b?"HIDE":"SHOW");tq(a.cb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);z(a.Ti("waffle-assistant-faceted-chart"),function(a){on(a,b)});a.C&&O(a.C.Ma,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');TW(c,b?a:d)}
function isc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function jsc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function gsc(a){a.O&&!a.Z&&z(a.Ga,u(function(a){var b=a.Ma;if(!this.O.contains(b)){var d=this.O;a=new ksc(b,a);wsb(d,a)}},a))}p.t0b=function(){hsc(this,2649)};p.s0b=function(){hsc(this,2648);this.V.show(!0)};function hsc(a,b){var c=a.Kb,d=new zV,e=a.H.getChartType();d.C=e;e=a.H.Qd();d.F=e?e.clone():null;AV(c,b,d,10,a.H,a.H.tf())};function lsc(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(On?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(On?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function VW(a,b){var c=this;P.call(this,b);this.D=a;this.V=this.O=this.qa=null;this.gb=new $V(!0,"#4285f4");this.Xa(this.gb);this.jb=this.Mb=this.kc=!1;this.Pa=new Cl(function(){c.Pa.stop();c.Ma.parentNode.querySelector(":hover")==c.Ma?c.Pa.start():c.gT()},100);this.Ca(this.Pa);this.bd=this.Ib=!1}w(VW,P);p=VW.prototype;p.ZD=fd;p.$aa=gd;p.YL=hd;p.XL=hd;p.r$=hd;p.Oma=hd;p.Nma=hd;p.hf=ca("bd");p.Fd=g("bd");p.Boa=ma;p.Ia=function(){this.Ma=T(lsc)};
p.Wa=function(){VW.$.Wa.call(this);var a=this.cb("waffle-assistant-card-spinner-container");this.gb.render(a);Mo(this.cb("waffle-assistant-card-inner"),"visibility","hidden");if(this.ZD()){var a=this.Ma,b=new wq(a);this.Ca(b);this.getHandler().R(b,"focusin",this.Pmb).R(b,"focusout",this.Omb).R(a,"mouseenter",this.$0).R(a,"mouseleave",this.gT)}msc(this,!1);On&&(this.V=new asc(this.dG(),this.Ba()),this.V.render(this.cb("waffle-assistant-card-feedback-container")),this.getHandler().R(this.V,"feedback-dialog-opened",
this.Urb).R(this,"trigger_feedback",this.nWb),this.$aa()?(this.O=new UW(this.Ba()),this.O.render(this.cb("waffle-assistant-thumbs-container")),nsc(this,!0),a=cb(this.r$()),Na(a)||csc(this.O,a),a=cb(this.Oma()),Na(a)||TW(this.O.cb("waffle-assistant-thumbs-up-button"),a),a=cb(this.Nma()),Na(a)||TW(this.O.cb("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.O,"thumbs-down",this.H0b).R(this.O,"thumbs-up",this.I0b)):nsc(this,!1));this.sI()};
function WW(a){return a.cb("waffle-assistant-card-content-container")}function osc(a){a.ZD();return a.cb("waffle-assistant-card-options")}function nsc(a,b){On&&O(a.cb("waffle-assistant-thumbs-container"),a.$aa()&&b)}p.xK=function(){this.isDisposed()||(this.kc=!0,psc(this))};function qsc(a,b){!a.Mb&&b&&(a.Mb=!0,psc(a))}function psc(a){if(a.kc&&a.Mb){var b=u(a.G0b,a);a.yI(b)}}p.$0=function(){this.jb||(msc(this,!0),this.jb=!0,this.Pa.start())};p.gT=function(){msc(this,!1);this.jb=!1};
p.Pmb=function(){msc(this,!0)};p.Omb=function(){var a=this,b=new Cl(function(){kn(a.Ma,document.activeElement)||a.Ma.parentNode.querySelector(":hover")==a.Ma||msc(a,!1)},0);this.Ca(b);b.start()};p.H0b=function(){rsc(this,!0);nsc(this,!1);var a=this.XL();this.dispatchEvent(new QW("ue",this,a))};p.I0b=function(){nsc(this,!1);var a=this.YL();this.dispatchEvent(new QW("ue",this,a))};p.Urb=function(){rsc(this,!1)};p.nWb=function(){rsc(this,!0)};
function msc(a,b){var c=a.cb("waffle-assistant-card-options");a=a.ZD();O(c,a&&b)}p.G0b=function(){this.gb.setActive(!1);O(this.gb.Ma,!1);Mo(this.cb("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new G("content-rendered"))};function rsc(a,b){tq(a.cb("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.V.show(b)};var ssc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function tsc(a){var b=new sE(lc(ssc));return Pnc(a,b)}
function usc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.dc("useFirstColumnAsDomain")&&a.Qd()&&"number"===a.Qd().fd(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.dc("useFirstColumnAsDomain")&&a.Qd()&&"string"===a.Qd().fd(0)){var c=0,d=Wm("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Qd().getNumberOfRows();b++)mn(d,a.Qd().Uf(b,0)),c=Math.max(c,np(d).width);cn(d);c=Math.min(27,Math.max(15,10+100*c/271))}eo()||Wn||(a.setOption("chartArea.top","15%"),b=a.dc("hAxis.title"),a.setOption("chartArea.height",Na(cb(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Na(cb(a.dc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function vsc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function wsc(){return V(U(Ss({Ce:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Mr(""+U(fu({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(Ss({Ce:"waffle-assistant-zoom-button",content:Mr(""+U(fu({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function XW(a,b,c,d,e,f){VW.call(this,a,f);this.C=B(a,8);this.Jc=b;this.zc=c;this.Kb=d;this.bb=e;this.L=new Ts("",this.Ba());this.Xa(this.L);this.Z=new Ts("",this.Ba());this.Xa(this.Z);this.Ee=new Rg;this.Wb=null;this.Sa=!1;this.Vb=[];this.Qb=[];this.xb=[];this.Za=this.Ja=this.F=this.H=this.Ga=null;this.J=qj(new pj,10).build()}w(XW,VW);
var YW={WYa:"waffle-assistant-after-chart-preview",pZa:"waffle-assistant-before-chart-preview",CZa:"waffle-assistant-card-draggable",M5:"waffle-assistant-chart-highlights",f1a:"waffle-assistant-insert-chart-button",Nga:"waffle-assistant-chart-preview",d3a:"waffle-assistant-button-separator",z3a:"waffle-assistant-styled-border",A3a:"waffle-assistant-styled-rect",z4a:"waffle-assistant-zoom-button"};p=XW.prototype;p.yI=function(a){this.Wb=a;xsc(this)};
p.sI=function(){ysc(this,u(function(a){a=Soc(this.Jc,a);mq(this.Ma,a)},this),!1)};p.ZD=gd;p.dG=n("autovisFeedback");p.YL=n(2208);p.XL=n(2207);p.r$=n("Was this chart useful?");p.Ia=function(){XW.$.Ia.call(this);WW(this).appendChild(T(vsc));osc(this).appendChild(T(wsc));rc(this.C,22)&&(this.F=new esc(this.C,this.qa,this.Kb,this.bb,this.Ba()),this.Xa(this.F,!0),this.F.hf(this.Fd()))};
p.Wa=function(){XW.$.Wa.call(this);pq(this.Ma,YW.CZa);var a=this.cb(YW.f1a);this.L.ob(a);TW(a,"Insert chart");a=this.cb(YW.z4a);this.Z.ob(a);TW(a,"View full size");var a=this.cb(YW.pZa),b=this.cb(YW.Nga),c=this.cb(YW.WYa);this.getHandler().R(this.Ma,"keydown",this.p0b).R(b,"click",this.vnb).R(a,"focus",this.pmb).R(c,"focus",this.hlb).R(this.L,"action",this.Aub).R(this.L.Ma,"mousedown",this.Pg).R(this.Z,"action",this.uGb).R(this.Z.Ma,"mousedown",this.Pg).R(this.cb(YW.M5),"mousedown",this.Pg).R(ew(this.Jc),
"Da",this.q0b);zsc(this);this.Kb.fc(2790,this.J);this.F&&this.Kb.fc(2791,this.J)};p.hf=function(a){XW.$.hf.call(this,a);zsc(this);this.wc()&&Asc(this)};function zsc(a){if(a.wc()){var b=a.Fd();a.L.setVisible(!b);a=a.Ba().cb(YW.d3a,osc(a));O(a,!b)}}p.p0b=function(a){13==a.keyCode&&a.target==this.Ma&&(a.preventDefault(),a.stopPropagation(),Bsc(this,2255))};
function Csc(a){for(var b=a.getChartType(),c=!!B(a.C,14),d=B(a.C,16),e=!!B(a.C,15),f="Histogram"==b,b="PieChart"==b,h=fU(wc(a.D,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var q=Dsc(h[m].rect,c!=b);Ib(l,q)}var c=Hz(a.zc).kd(),r=[];for(v in Hd)r.push(c.C4(Hd[v]));var v=pb(l,function(a){return pb(r,Ca(ee,a))});f&&e&&(v=Jb(v,1));a.xb=Esc(v.length,b&&0<d||!f&&!b&&e,b&&k);d=Hz(a.zc);for(e=0;e<v.length;e++)for(f=a.xb[e],b=0;b<v[e].length;b++)v[e][b]&&ne(v[e][b])&&(k=yT(d,v[e][b],YW.A3a),a.Ca(k),TI(KJ(d),
k,!0),Mo(k.Ma,"background-color",f),k.setVisible(!0),a.Vb.push(k),k=DJ(d,v[e][b],YW.z3a,1,0),a.Ca(k),gob(k,f),k.setVisible(!0),a.Qb.push(k))}function Fsc(a){Ac(a.Vb);Ac(a.Qb);a.Vb=[];a.Qb=[];a.xb=[]}p.q0b=function(){this.Sa&&(Fsc(this),Csc(this))};p.$0=function(){XW.$.$0.call(this);this.Ja=Ea();this.Sa||(Csc(this),this.Sa=!0)};p.gT=function(){XW.$.gT.call(this);xa(this.Ja)&&500<Ea()-this.Ja&&this.Kb.fc(2789,this.J);this.Ja=null;Fsc(this);this.Sa=!1};p.vnb=function(){this.Ma.focus()};
p.pmb=function(){var a=this.cb(YW.M5);jp(a)?a.focus():this.Ma.nextSibling&&this.Ma.nextSibling.focus()};p.hlb=function(){var a;if(a=this.V)a=this.V,a.Eb("waffle-assistant-feedback-card-hidden")?a=!1:(a.cb("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Z.Ma.focus()};p.Aub=function(){this.Kb.fc(2255,this.J);Bsc(this,2255)};p.Pg=function(a){a.stopPropagation()};p.uGb=function(){S.W4.Dc(this)};p.Boa=function(a,b){Bsc(this,2257,a,b)};
function Bsc(a,b,c,d){ysc(a,u(function(a){a=new Xrc(a,this.qa,this.H&&this.H.Qd(),b,c,d);this.dispatchEvent(a)},a),!1)}
p.r0b=function(a,b){if(b){var c=this.cb(YW.Nga);if(b.Ci())gE.tB(c,b);else{a.Zd(b.Qd());qV(a,a.Qd());WT(a,"ready",u(this.o0b,this,a));b=[];try{var d=new gg;d.setContext(a.toJSON());var e=!!B(this.C,14);D(d,3,e);var f=B(this.C,16);D(d,4,f);D(d,5,"ROWS"==(e?"ROWS":"COLS"));D(d,8,0);if(B(this.C,24)){var h=B(this.C,25);D(d,9,h)}for(var k=fU(wc(this.D,4)),e=0;e<k.length;e++)d.addRange(Vg(k[e].rect,k[e].Xc));var l=this.Ee.serialize(d);b=pb(zpc(Ca(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
wpc)}catch(m){b=[]}d=this.cb(YW.M5);O(d,0<b.length);0<b.length&&(d.appendChild(b[0]),on(d,!0));this.H=a;EV(a,c,this.Kb,Wn)}}};p.o0b=function(a){null!==this.Ga&&(ri(pi(),this.Ga),this.Ga=null);this.isDisposed()||(a.wm()&&(hE(a.wm(),"onmouseover",u(this.m0b,this)),hE(a.wm(),"onmouseout",u(this.n0b,this))),this.Wb(),Asc(this))};p.m0b=function(){this.Za=Ea()};p.n0b=function(){xa(this.Za)&&500<Ea()-this.Za&&this.Kb.fc(2795,this.J);this.Za=null};
function Asc(a){if(a.bb&&!a.Fd()){var b=a.cb(YW.Nga);if(!a.bb.contains(b)){var c=a.bb;a=new ksc(b,a);wsb(c,a)}}}function Gsc(a){a.Ib&&(a.Ga=qi(pi(),ok.Qwa),a.Ib=!1);B(a.C,16);var b=tsc(a.C);b.Jda(HE);var c=Rnc(a.D);b.Vh(c.toString());a.F&&(c=c.clone(),a.F.F=c);return b}
function xsc(a){var b=Gsc(a),b=usc(b,a.cb("waffle-assistant-card-inner"));(new WU(HE,b.tf())).send(u(a.r0b,a,b));a.F&&ysc(a,u(function(a){var c=this.F,e=b;a=new sE(a.toJSON());var e=new sE(e.toJSON()),f=c.Ti("waffle-assistant-faceted-chart");if(1<f.length){jsc(a);var h=e;isc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");eo()||Wn||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,jsc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),isc(e);h=fU(wc(c.J,27));A4a(c.F,h);for(var h=B(c.J,25),k=0;k<f.length;k++){var l=va(c.L[k])?c.L[k]:null,m=h.clone(),q=c.Ja,r=new lg;D(r,1,q);va(l)&&r.ib(l);D(m,7,r);c.F.Sb("dt",encodeURIComponent(JSON.stringify(c.Ee.serialize(m))));
q=new sE(a.toJSON());q.Vh(c.F.toString());m=e.clone();m.Vh(c.F.toString());var v=c,x=q.dc("title");x||(x=wrc(q));r=x+(' when "'+(v.D+('" is "'+(l+'"'))));v=x+(' by "'+(v.D+'"'));r=l?r:v;q.setOption("title",r);m.setOption("title",r);v=new Zrc(q,m,0,0,c.Pa,c.Kb,c.Ba());c.Xa(v);r=f[k];v.ob(r);c.Ga.push(v);v=c;x=wrc(q);q=x+(' broken down by "'+(v.D+('" for "'+(l+'"'))));v=x+(' broken down by "'+(v.D+'"'));mq(r,l?q:v);c.H=m}gsc(c);c.Ma.style.visibility="visible"},a),!1)}
function ysc(a,b,c){var d=Gsc(a);(new WU(HE,d.tf())).send(function(a){a?(a=a.Qd(),c&&d.Zd(a),qV(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function Esc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=Fmc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Ib(d,d);return d}function Dsc(a,b){return b?qkc(a,new Sd(a.width,1)):qkc(a,new Sd(1,a.height))};function Hsc(){SJ.call(this);this.Sa.push(this);this.Ga=this.Ja=!0;this.jb="waffle-assistant-dragged-card"}w(Hsc,vsb);Hsc.prototype.contains=function(a){return!!z(this.L,function(b){if(b.element==a)return!0})};Hsc.prototype.Zma=function(a){var b=Hsc.$.Zma.call(this,a);if(eo()||Wn){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=pb(b.querySelectorAll("clippath"),function(a){return a.id}),Isc(b,a);return b};
function Isc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];va(c)&&Va(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=en(a);for(c=0;c<a.length;c++)Isc(a[c],b)}function ksc(a,b){UJ.call(this,a,b)}w(ksc,UJ);ksc.prototype.ana=g("element");function Jsc(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function ZW(a,b){VW.call(this,a,b);this.C=B(a,8)}w(ZW,VW);p=ZW.prototype;p.sI=ma;p.dG=n("assistantWordCloudFeedback");p.YL=n(2634);p.XL=n(2633);p.Ia=function(){ZW.$.Ia.call(this);WW(this).appendChild(T(Jsc));pq(WW(this),"waffle-assistant-word-cloud-content-container")};
p.yI=function(a){for(var b=wc(this.C,19),c=wc(this.C,20),d=this.cb("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(Ksc(this,b,c,e),120<d.clientHeight){Ksc(this,b,c,e-1);break}b=this.Ba();c=B(this.C,2);c=yn(b,c);d=this.cb("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function Ksc(a,b,c,d){var e=a.cb("waffle-assistant-word-cloud-words-container");for(a=a.Ba();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){k&&e.appendChild(yn(a," "));var l=a.createElement("SPAN");a.appendChild(l,yn(a,b[k]));a.appendChild(e,l);pq(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=k%2?"#61443C":"#00695C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function Lsc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function Msc(){var a=V;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+U(Lsc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function Nsc(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(Ss({Ce:"waffle-assistant-panel-back-button",content:Mr(""+U(fu({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function $W(a){P.call(this,a);this.bd=new $V(!1,"#4285f4");this.Xa(this.bd);this.L=new P(this.Ba());this.Xa(this.L);this.C=[];this.We=this.Xe=!1;this.Ed=this.Ad=this.Ib=this.Z=null;this.kc=new Ts("",a,4);xr(this.kc,2,!1);this.Xa(this.kc)}w($W,P);var Osc={defaultHelpArticleId:"6280499"};p=$W.prototype;p.Ia=function(){$W.$.Ia.call(this);this.Ma=T(Msc);this.Ad=this.cb("waffle-assistant-panel-content-container");this.Ed=this.cb("waffle-assistant-empty-list")};
p.Wa=function(){$W.$.Wa.call(this);var a=this.cb("waffle-assistant-spinner-container");this.bd.render(a);this.L.ob(this.cb("waffle-assistant-panel-card-holder"));this.kc.ob(this.cb("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.kc,"action",this.J0b).R(this.Ma,"scroll",Clc(this.lYa,10,this))};p.setVisible=function(a){var b=this;O(this.Ma,a);z(this.C,function(a){if(!a.wc()){var c=b.L.hd();a.qa=c;b.L.Xa(a,!0);a.xK()}});this.Xe=a};
p.Ysa=function(a,b){var c=this.Ba();this.Z&&this.t8();this.Z=new P;this.Xa(this.Z);a=dr(a,Nsc,{title:b});this.Ib=new Ts("",this.Ba());this.Z.Xa(this.Ib);this.Ib.ob(c.cb("waffle-assistant-panel-back-button",a));TW(this.Ib.Ma,"Back");this.Z.getHandler().R(this.Ib,"action",this.fmb)};p.t8=function(){this.Z.dispose();this.Z=null};function Psc(a,b){a.bd.setActive(b);O(a.cb("waffle-assistant-panel-pane"),!b)}p.hI=function(a){O(this.Ed,a);O(this.Ad,!a)};
function Qsc(a,b){Eb(a.C,b);a.L.removeChild(b);a.L.Yh(b,0);a.C.push(b)}p.RH=function(a){Eb(this.C,a);-1!=xp(this.L,a)&&this.L.removeChild(a,!0)};p.wZ=function(){this.L.Gd(!0);Ac(this.C);this.C=[]};p.lYa=function(){for(var a=this.Ma,a=a.scrollTop+gp(a).height,b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(qsc(d,!0),b+=gp(d.Ma).height):qsc(d,!1)}};p.hf=function(a){this.We=a;z(this.C,function(b){b.hf(a)})};p.Fd=g("We");p.J0b=function(){Q.Go.Dc(Osc)};p.fmb=function(){this.dispatchEvent("me")};function Rsc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(Ss({Ce:"waffle-assistant-section-more-button",content:Mr("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function aX(a,b,c,d){P.call(this,d);this.V=a;this.bb=b;this.Z=new Ts("",this.Ba());this.Xa(this.Z);this.J=new P(this.Ba());this.Xa(this.J);this.C=null;this.Za=[];this.Sa=this.Pa=!1;this.Kb=c}w(aX,P);p=aX.prototype;p.jOa=fd;p.cua=gd;p.Ia=function(){aX.$.Ia.call(this);this.Ma=T(Rsc,{title:this.D4()})};
p.Wa=function(){aX.$.Wa.call(this);this.J.ob(this.cb("waffle-assistant-section-card-holder"));this.Z.ob(this.cb("waffle-assistant-section-more-button"));this.getHandler().R(this.Z,"action",this.Xwb);this.C=this.iEa();this.Ca(this.C);O(Ssc(this),this.jOa());this.setVisible(!1)};p.setVisible=function(a){if(this.wc()&&this.mb()!=a&&(O(this.Ma,a),a)){O(this.Z.Ma,this.GVa());a=new Bma;M(a,4,this.ewa());var b=new hj;cj(b,58,a);a=rj(qj(new pj,10),b).build();this.Kb.fc(2774,a)}};
p.mb=function(){return this.wc()&&jp(this.Ma)};p.GVa=function(){return this.Za.length>this.V};p.iEa=function(){return new $W(this.Ba())};p.hf=function(a){this.Sa=a;z(Tsc(this),function(b){b.hf(a)});this.C.hf(a)};p.Fd=g("Sa");p.lh=ma;
p.dwa=function(a){this.Za=a;for(var b=0;b<a.length;b++){if(this.J.hd()<this.V){var c=this.e8(a[b]);c.hf(this.Sa);var d=this.J.hd();c.qa=d;this.J.Xa(c,!0)}if(this.cua()&&(this.C.hI(!1),c=this.C,d=this.e8(a[b]),c.C.push(d),c.Xe)){Psc(c,!1);var e=c.L.hd();d.qa=e;c.L.Xa(d,!0);d.xK()}}};function Tsc(a){var b=[];a.J.Jf(function(a){b.push(a)});return b}function Ssc(a){return a.cb("waffle-assistant-section-content")}p.npa=function(){return this.J.Taa()};
p.dW=function(){this.Za=[];Ac(this.J.Gd(!0));this.setVisible(!1);this.cua()&&(this.C.wZ(),this.C.hI(!0))};function Usc(a){a.J.Jf(function(a,c){c<this.V&&a.xK()},a)}p.fwa=function(a){var b=0;if(this.Pa)this.C.lYa();else if(this.npa()){this.setVisible(!0);for(var b=gp(this.cb("waffle-assistant-section-header")).height+gp(Ssc(this)).height,c=Tsc(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.vLa(c[d]),qsc(c[d],!0),b+=gp(c[d].Ma).height):qsc(c[d],!1)}else this.setVisible(!1);return a-b};p.vLa=ma;
p.setActive=function(a){(this.Pa=a)||this.C.t8()};p.Zb=g("Pa");function Vsc(a,b){a.C.Ysa(b,a.D4())}p.Xwb=function(){this.setActive(!0);this.dispatchEvent("re")};p.ju=g("Kb");function bX(a,b,c,d,e){aX.call(this,20,d,c,e);this.O=a;this.L=b;this.D=new Hsc;this.Ca(this.D);this.F=null;this.H=0}w(bX,aX);p=bX.prototype;p.Wa=function(){bX.$.Wa.call(this);this.D.Ue();this.getHandler().R(this.D,"drag",this.l0b).R(this.D,"dragend",this.Om)};p.D4=n("Analysis");p.Via=function(a){return 0==a};p.e8=function(a){return"WordCloud"==B(a,8).getChartType()?new ZW(a,this.Ba()):new XW(a,this.O,this.L,this.ju(),this.D,this.Ba())};p.hf=function(a){bX.$.hf.call(this,a);a&&qsb(this.D)};
p.vLa=function(a){this.getHandler().Ic(a,"content-rendered",this.k0b);this.H++};p.k0b=function(){--this.H||this.dispatchEvent("oe")};p.l0b=function(){this.F=cp(this.D.ad.target)};p.Om=function(a){var b=this.F,c=Hz(this.L).Xd();if(Wd(TG(c,"page",!1,!1)).contains(b)){var d=RG(c,b.x,b.y,"page"),c=VG(c,ce(d),"page"),b=new Ld(b.x-c.left,b.y-c.top);a.C.getData().Boa(d,b)}this.F=null};p.ewa=n(2);var Wsc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),Xsc=[{Zj:["Thank you","Thankyou","Thanks"],Qg:"No problem"},{Zj:["you are amazing","This is great","omg"],Qg:"Happy to help"},{Zj:["I love you"],Qg:"Must be in the air"},{Zj:["How do you know","How are you so smart"],Qg:"It's all in the data"},{Zj:["Are you sure"],Qg:"Send feedback if this doesn't seem correct to help improve accuracy"},{Zj:["How are you"],Qg:"Pretty good, thanks"},
{Zj:["Hi","Hello","Hey"],Qg:"Hi, there. Try asking a question about your data."},{Zj:["You are stupid","This is dumb","You are wrong"],Qg:"Help improve this experience by sending feedback"},{Zj:["How smart are you"],Qg:"Pretty smart"}];function Ysc(a){for(var b=0;b<Xsc.length;++b)if(-1!=vb(Xsc[b].Zj,function(b){return Ja(a,b)}))return b;return-1};function cX(a,b,c,d,e,f,h){this.C=a;this.VY=b;this.H=(void 0===h?null:h)||b;this.D=d;this.Cq=c;this.Ga=d?wc(d,6):[];this.Ja=d?wc(d,7):[];this.qa=d?wc(d,8):[];this.error=e||1;this.interpretation=d&&rc(d,4)?B(d,4):null;this.O=d?wc(d,12):[];this.Z=f;this.V=!1;this.L=[];this.J=!1;this.F=null;if(this.D&&rc(this.D,17))if(c=B(this.D,17),this.V=B(c,4)||!1,a=wc(c,3),b=wc(c,1),0<a.length)if(!b.length||1>=this.H.length||1>this.H[0].length)this.L.push("Charts for this question are not supported.");else{for(c=
0;c<b.length;c++)if(wb(a,b[c])){this.J=!0;this.F=b[c];break}null==this.F&&10==a[0]&&wb(b,2)&&(this.J=!0,this.F=2);null==this.F&&(this.J=!0,this.F=Zsc(this,b),1==a.length&&6==a[0]||this.L.push("Requested chart type is not supported for this question."))}else 0<b.length&&1<this.H.length&&1<this.H[0].length&&(this.F=Zsc(this,b),this.J=B(c,2)||!1,20<=this.H.length||3<=this.H[0].length)&&(this.J=!0)}function $sc(a){return 1==a.error&&null!=a.Cq}
function atc(a){return{xN:btc(a),interpretation:a.interpretation,VY:a.VY,Cq:a.Cq,T1:1<a.VY.length&&1<a.VY[0].length,Pm:a.Pm(),FUb:a.V,EHb:a.L}}cX.prototype.Pm=function(){var a;if(a=Un&&null!=this.F)a:switch(this.F){case 2:case 3:case 4:case 5:case 10:case 7:a=!0;break a;default:a=!1}return a&&2<this.H.length};
cX.prototype.getChartType=function(){if(!this.Pm())return null;switch(this.F){case 2:return"ColumnChart";case 3:return"LineChart";case 4:return"ScatterChart";case 5:return"PieChart";case 10:return"Histogram";case 7:return"LineChart";default:throw Error("Unknown chart type.");}};function ctc(a){if(!a.D||!rc(a.D,17))return null;var b=B(a.D,17);D(b,2,a.J);return b}function dtc(a){a.Pm();return a.H[0][0]}
function etc(a){return pb(wc(a.D,18),function(b){if(B(b,2)){var c=a.Z.C;return xw(B(b,2),c)}},a)}function ftc(a){return{xN:btc(a),error:gtc(a)}}function Zsc(a,b){if(!wc(a.D,18).length)return b[0];a=htc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(wb(b,a[c]))return a[c];return b[0]}function itc(a,b,c){var d={};null!=b?(d.v=jtc(a,b,c),d.f=b):d.v=null;return d}
function htc(a){for(var b=new ZD,c=a.H[0],d=Jb(a.H,1),e=wc(a.D,18),f=[],h=0;h<c.length;h++)e[h]&&rc(e[h],1)?f.push(ktc(B(e[h],1))):f.push(h?"number":"string"),b.ct({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){for(var h=[],k=0;k<c.length;k++)h.push(itc(a,d[e][k],f[k]));b.Vw(h)}return b}
function jtc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return b=b||"0",a=HLa(a.Z.L.C).DECIMAL_SEP,b=b.replace(new RegExp("[^0-9"+a+"]","g"),""),b=b.replace(a,"."),jb(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Oa(a[0])&&Oa(a[1])&&(Oa(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Oa(a[d])&&
(c[d]=jb(a[d]));"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function ktc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function ltc(a){if(!rc(a.D,9))return"";if(rc(a.D.getError(),3))switch(B(a.D.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.D.getError().vm()||""}
function gtc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return ltc(a)||"Sorry, couldn't understand your question.";case 7:return a=Ysc(a.C),-1!=a?Xsc[a].Qg:""}return""}
function btc(a){var b=[];if($sc(a)){var c=[];z(Gb(a.Ga,a.qa),function(a){c.push(mtc(a,"waffle-assistant-answercard-question-unused-phrase"))});z(a.Ja,function(a){c.push(mtc(a,"waffle-assistant-answercard-question-used-entity"))});Nb(c,function(a,b){return a.KV>b.KV?1:-1});var d=0;z(c,function(c){var e=c.length,h=c.KV;h>d?b.push({text:a.C.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.C.substring(h,d),className:c.bk}))});d<a.C.length&&b.push({text:a.C.substring(d),className:null})}else b.push({text:a.C,
className:null});return b}function mtc(a,b){return{KV:B(a,2),length:B(a,3),bk:b}};function ntc(a){this.Kb=a}function otc(a,b){var c=new HW;M(c,3,b);M(c,8,Pva);b=new FT;cj(b,4,c);c=new hj;cj(c,46,b);c=rj(qj(new pj,10),c).build();a.Kb.fc(2753,c)};function ptc(a,b,c,d,e,f){G.call(this,"sqc");this.V=a;this.J=f||"";this.L=b;this.F=d;this.Z=e;this.C=c}w(ptc,G);function qtc(a,b,c,d){var e=new Brc;M(e,2,c);z(b,function(a){L(e,1).push(a)});M(e,3,d);d=new GW;M(d,1,a);M(d,3,b[c]);cj(d,11,e);return d}function rtc(a,b,c,d){var e=new Drc;M(e,2,c);z(b,function(a){L(e,1).push(a)});M(e,3,d);d=new GW;M(d,1,a);M(d,2,b[c]);cj(d,10,e);return d}function stc(a){var b=new Erc;z(a,function(a){var c=a.type;L(b,1).push(c);a.$Ha&&(a=a.$Ha,L(b,2).push(a))});return b}function ttc(a){var b=new Crc;z(a,function(a){a=a.type;L(b,1).push(a)});return b}
function utc(a){var b=new Arc,c=wc(a,3),d=wc(a,1);if(0<c.length){for(var e,f=0;f<d.length;f++)if(wb(c,d[f])){e=d[f];break}e||(e=c[0]);M(b,2,e)}for(c=0;c<d.length;c++)e=d[c],L(b,3).push(e);a=B(a,2);M(b,4,a);return b};function vtc(a,b,c){this.J=a;this.D=[];this.C=[];this.F=b;this.H=c}w(vtc,E);function dX(a,b){eX(a);wtc(a,b)}function wtc(a,b){if(b){var c=Hz(a.J),d=c.kd(),d=pb(Zb(Hd),d.C4,d);b=pb(d,Ca(ee,b.rect));for(d=0;d<b.length;d++)if(b[d]&&ne(b[d])){var e=yT(c,b[d],a.H);a.Ca(e);TI(KJ(c),e,!0);e.setVisible(!0);a.D.push(e);e=DJ(c,b[d],a.F,1,0);a.Ca(e);e.setVisible(!0);a.C.push(e)}}}function eX(a){Ac(a.D);Ac(a.C);a.D=[];a.C=[]};function fX(a,b,c,d){H.call(this);this.O=a;this.V=b;this.qa=c;this.Sa=d;this.Qa=new J(this);this.Ca(this.Qa);this.C=new SV;this.Ca(this.C);this.L="";this.J=[];this.F=this.D=this.H=null;this.Z=!1;fpc(this.C,this.O);this.C.Ga=10;this.C.gb=!0;this.C.O=!1;this.C.VUa("waffle-assistant-visible");this.C.qa=Pa("waffle-assistant-dragged-formula").split(" ");this.C.Ue();this.Qa.R(this.C,"beforedragstart",this.Ja).R(this.C,"dragmove",this.Pa).R(this.C,"beforedragend",this.Ga)}w(fX,H);fX.prototype.hf=ca("Z");
fX.prototype.Ja=function(a){a=mb(this.O.childNodes,a.C);this.L=this.J[a]};
fX.prototype.Pa=function(a){var b=a.event instanceof Eq?a.event.dM:a.event;this.Z?(a.J.Dz(b,!0),a.preventDefault()):(Vo(a.F,a.event.clientX,a.event.clientY),a=Wo(a.F),b=Hz(this.V).Xd(),Wd(TG(b,"page",!1,!1)).contains(a)?(a=RG(b,a.x,a.y,"page"),(b=wx(gw(this.qa),a.y,a.x))?a=new Ld(b.hc(),b.qc()):b=ce(a),this.H=a,this.D&&this.D.getRect().equals(b)||(a=Hz(this.V),F(this.D),this.D=yT(a,b,"waffle-assistant-formula-insertion-rect"),this.Ca(this.D),TI(KJ(a),this.D),F(this.F),this.F=DJ(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.Ca(this.F),gob(this.F,"#000"),this.F.setVisible(!0))):xtc(this))};fX.prototype.Ga=function(a){if(this.H){var b=this.H,c=gw(this.qa),b=new mH(c,b,this.L);this.Sa.C(b);this.dispatchEvent(new G("formula_inserted"))}a.J.Dz(null,!0);a.preventDefault();this.L="";xtc(this)};function xtc(a){a.H=null;F(a.D);a.D=null;F(a.F);a.F=null};function ytc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(fu({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=U(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(b)+"</div>";
return V(a+"</div></div>")};function ztc(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+Atc({xN:a.eF.xN}),d=a.eF.VY;var e=a.eF.Cq;var f=a.eF.interpretation,h=a.eF.T1,k=a.eF.Pm,l=a.eF.FUb;a=a.eF.EHb;!d||ra(d);ra(a);var m=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Pr("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){if(!l){k&&(m+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab">CHART</div></div>');m+='<div class="waffle-assistant-answercard-answer">';if(h){m+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=d[0],f=l.length,q=0;q<f;q++)m+='<span class="waffle-assistant-answercard-answer-col">'+
U(l[q])+"</span>";m+="</div>"}m+='<div class="waffle-assistant-answercard-answer-rows">';l=Lr("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));f=d.length;for(q=0;q<f;q++){var r=d[q];if(!h||q){var v=l;ra(r);for(var v='<div class="'+W(v)+'">',x=r.length,y=0;y<x;y++)var C=r[y],v=C?v+('<span class="waffle-assistant-answercard-answer-col">'+U(C)+"</span>"):v+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>');r=V(v+"</div>")}else r="";m+=r}m+="</div></div>"}m+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart"></div></div>':""}if(0<a.length){m+='<div class="waffle-assistant-answercard-info-msgs">';d=a.length;for(h=0;h<d;h++)m+='<div class="waffle-assistant-answercard-info-msg">* '+U(a[h])+"</div>";m+="</div>"}m+='<div class="waffle-assistant-answercard-footer">';k&&(m+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');
m+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+U(fu({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+
U(e)+"</div></div></div></div></div></div></div>";e=V(m);return b(c+e+"</div></div>")}
function Atc(a){ra(a.xN);a=a.xN;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Pr("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+"</div></div></div>")}
function Btc(){var a=V;var b=V('<div class="waffle-assistant-answers-card-remove">'+U(fu({icon:"docs-icon-img docs-icon-trash"}))+"</div>");return a(U(b))};function gX(a,b,c,d,e,f,h,k,l,m,q){VW.call(this,new LV,q);this.C=a;this.We=etc(a);this.Jc=a.Pm();this.Yd=a.Pm()&&a.J;this.Wb=a.V;this.Ja=!1;this.Qb=b;this.xb=c;this.Vb=d;this.zc=l;this.uf=h;this.Kb=e;this.Ed=f;this.Ad=k;this.De=m;this.le=qj(new pj,10).build();this.bb=new Ls("",new SW,this.Ba());this.Xa(this.bb);this.L=null;this.J=new Ls("",new RW,this.Ba());this.Xa(this.J);this.Z=new Ls("",new RW,this.Ba());this.Xa(this.Z);this.Ga=new Ls("",new SW,this.Ba());this.Xa(this.Ga);this.H=new rU;this.Xa(this.H);
this.F=null;this.xc=htc(this.C);this.Sa=new vtc(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.Ca(this.Sa);this.Za=!1}w(gX,VW);p=gX.prototype;p.Yla=g("Ad");p.Ia=function(){gX.$.Ia.call(this);osc(this).appendChild(T(Btc))};
p.Wa=function(){gX.$.Wa.call(this);var a=this.cb("waffle-assistant-answers-card-remove");this.bb.ob(a);TW(a,"Remove card",0);this.getHandler().Ic(this.bb,"action",this.y0b).R(this.J,"action",this.aCb).R(this.Z,"action",this.Ctb).Ic(this.J,"action",u(this.lQa,this,!0)).Ic(this.Z,"action",u(this.lQa,this,!1))};
p.yI=function(a){WW(this).appendChild(T(ztc,{eF:atc(this.C)}));this.J.ob(this.cb("waffle-assistant-answercard-see-formula-link"));this.Z.ob(this.cb("waffle-assistant-answercard-hide-formula-link"));this.L=new fX(this.cb("waffle-assistant-answercard-formula-text-container"),this.Qb,this.xb,this.Vb);this.L.hf(this.Fd());this.L.J=[this.C.Cq];this.Ca(this.L);var b=this.cb("waffle-assistant-answercard-formula-text");TW(b,"Click to copy or drag to insert",void 0,"Formula: "+(this.C.Cq+". Click/Press ENTER to copy or drag to insert on to sheet."));
tlc(b,this.Fd());Bi(this.getHandler().Ic(this.L,"formula_inserted",this.sJb),this.cb("waffle-assistant-answercard-formula-text"),Zc,this.Rsb);Ctc(this,this.De);if(this.Jc){if(this.Wb)Dtc(this),this.Ja=!0;else{this.H.ob(this.cb("waffle-assistant-answercard-tabs"));b=new pU("");b.ob(this.cb("waffle-assistant-answercard-formula-tab"));this.H.Xa(b);var c=new pU("");c.ob(this.cb("waffle-assistant-answercard-chart-tab"));this.H.Xa(c);this.getHandler().R(this.H,"select",this.jEb).Ic(b,"action",u(this.jQa,
this,0)).Ic(c,"action",u(this.jQa,this,1));this.H.xw(this.Yd?c:b)}b=this.cb("waffle-assistant-answercard-insert-chart");this.Ga.ob(b);Etc(this);this.getHandler().R(this.Ga,"action",this.x0b)}a()};
function Dtc(a){a.F=new FV;var b=a.C.getChartType();D(a.F,1,b);D(a.F,2,a.C.interpretation||"");if("Histogram"===b)b=dtc(a.C),D(a.F,3,b),D(a.F,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.xc.fd(0)&&(b=a.xc.dh(0),D(a.F,3,b),b=1),1==a.xc.getNumberOfColumns()-b?(b=a.xc.dh(b),D(a.F,6,b)):D(a.F,6,"Values");else{var b=a.F,c=dtc(a.C);D(b,3,c);c=a.C;c.Pm();D(b,6,c.H[0][1]||"")}b=tsc(a.F);b.Zd(a.xc);c=a.cb("waffle-assistant-answercard-chart");b=usc(b,c);qV(b,b.Qd());b.setOption("title",
"");EV(b,c,a.Kb,Wn);a.Ja=!0}
p.x0b=function(){if(this.F){var a=tsc(this.F);a.Zd(this.xc);qV(a,a.Qd());var b=gw(this.xb),c=Jw(b),d=$kc(b,c,!1),c=kC(b,d.y),b=lC(b,d.x),d=H4a(this.zc.J),c={oid:null,ar:c,ac:b,x:16,y:16,h:rC.height,w:rC.width,p:{context:{chartName:"Chart "+(d+1)}}},b=new og;D(b,2,"0.6");d=this.xc.toJSON();D(b,1,d);c=new EE(aw(this.xb)||0,c,!1,!1,b);zT(c,a);this.Qb.dispatchEvent(new VE("objectRequest"));this.Vb.C(new kH(this.zc,c));c=this.C.F;a=new yrc;M(a,1,c);c=new HW;cj(c,11,a);a=new FT;cj(a,4,c);c=new hj;cj(c,
46,a);a=rj(qj(new pj,10),c).build();this.Kb.fc(2874,a)}};p.sI=function(){mq(this.Ma,"Answer Card for question: "+this.C.C)};p.ZD=gd;p.dG=n("assistantAnswersFeedback");p.YL=n(2628);p.XL=n(2627);p.r$=n("Was this answer correct?");p.Oma=n("Correct");p.Nma=n("Incorrect");p.yO=g("C");p.hf=function(a){gX.$.hf.call(this,a);this.L&&this.L.hf(a);var b=this.Eb("waffle-assistant-answercard-formula-text");b&&tlc(b,a);Etc(this)};
p.$0=function(){gX.$.$0.call(this);if(!this.Za){var a=this.Sa,b=this.We;eX(a);for(var c=0;c<b.length;c++)wtc(a,b[c]);this.Za=!0}};p.gT=function(){gX.$.gT.call(this);eX(this.Sa);this.Za=!1};p.jEb=function(){switch(sU(this.H)){case 0:Ftc(this,!1);break;case 1:Ftc(this,!0);break;default:sU(this.H)}};
function Ftc(a,b){O(a.cb("waffle-assistant-answercard-chart-container"),b);O(a.cb("waffle-assistant-answercard-answer"),!b);O(a.cb("waffle-assistant-answercard-formula-holder"),!b);Etc(a);!a.Ja&&b&&Dtc(a)}function Etc(a){var b=(a.Wb||1==sU(a.H))&&!a.Fd();a.Ga.setVisible(b)}function Ctc(a,b){a.J.setVisible(!b);a.Z.setVisible(b);O(a.cb("waffle-assistant-answercard-formula"),b);b?a.cb("waffle-assistant-answercard-formula-text").focus():(a.J.Ma.focus(),a.J.bq(!0))}p.y0b=function(){otc(this.Ed,!0);this.dispatchEvent(new G("rc"))};
p.aCb=function(){Ctc(this,!0)};p.Ctb=function(){Ctc(this,!1)};p.lQa=function(a){var b=new HW;M(b,9,a);a=new FT;cj(a,4,b);b=new hj;cj(b,46,a);b=rj(qj(new pj,10),b).build();this.Kb.fc(2849,b)};p.jQa=function(a){var b=this.C.F,c=ctc(this.C),d=new Arc;c&&(d=utc(c));M(d,1,b);b=new zrc;cj(b,1,d);switch(a){case 0:M(b,2,2);break;case 1:M(b,2,1);break;default:M(b,2,0)}a=new HW;cj(a,10,b);d=new FT;cj(d,4,a);a=new hj;cj(a,46,d);a=rj(qj(new pj,10),a).build();this.Kb.fc(2850,a)};
p.sJb=function(){this.Kb.fc(2709,this.le)};p.Rsb=function(){var a=this.Ba().Tb(),b=a.createElement("textarea");b.textContent=this.C.Cq;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&hX(this.uf,"Formula copied to clipboard",this.Ba())};function Gtc(a){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(Atc({xN:a.kHa.xN}))+U(ytc({error:a.kHa.error,showHelp:a.showHelp}))+"</div></div>")}function Htc(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function iX(a,b,c,d,e){VW.call(this,new LV,e);this.H=a;this.Z=b;this.L=d;this.Ga=c;this.J=new Ls("",new SW,this.Ba());this.Xa(this.J);this.C=new Ls("",new RW,this.Ba());this.Xa(this.C);this.F=new Ls("",new RW,this.Ba());this.Xa(this.F)}w(iX,VW);p=iX.prototype;p.sI=function(){mq(this.Ma,"Error Card for question: "+this.H.C)};p.dG=n("assistantAnswersFeedback");p.ZD=gd;p.$aa=fd;p.Ia=function(){iX.$.Ia.call(this);osc(this).appendChild(T(Btc))};
p.Wa=function(){iX.$.Wa.call(this);var a=this.cb("waffle-assistant-answers-card-remove");this.J.ob(a);this.F.setVisible(this.L);TW(a,"Remove card",0);this.getHandler().Ic(this.J,"action",this.D0b).Ic(this.C,"action",this.lCb).R(this.F,"action",this.C0b)};
p.yI=function(a){WW(this).appendChild(T(Gtc,{kHa:ftc(this.H),showHelp:this.L}));if(On){var b=T(Htc);this.Ba().appendChild(this.Ma,b);this.C.ob(this.cb("waffle-assistant-answercard-feedback-link"))}this.L&&this.F.ob(this.cb("waffle-assistant-answers-helpcenter-link"));a()};p.Yla=g("Z");p.yO=g("H");p.lCb=function(){this.C.setVisible(!1);O(this.cb("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new G("trigger_feedback"))};p.D0b=function(){otc(this.Ga,!1);this.dispatchEvent(new G("rc"))};
p.C0b=function(){Q.Go.Dc()};function Itc(a){VW.call(this,new LV,a);this.C=this.Ba().createElement("div");mn(this.C,"Previous")}w(Itc,VW);p=Itc.prototype;p.sI=function(){mq(this.Ma,"Previous questions below")};p.Ia=function(){Itc.$.Ia.call(this);rq(this.Ma,"waffle-assistant-card");pq(this.Ma,"waffle-assistant-answers-previousheadercard")};p.yI=function(a){0<this.Ba().ai(WW(this)).length||WW(this).appendChild(this.C);a()};p.$aa=fd;p.dG=n("assistantAnswersFeedback");function Jtc(a){var b=""+((a.o9?U(ytc({error:a.o9,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":""));var c=Lr("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.xVb;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(fu({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+U(f)+"</div></div></div>"}return V(b+"</div>")};function jX(a,b,c,d,e,f){VW.call(this,a,f);this.C=e||null;this.Z=b;this.F=d;this.Ga=c;this.L=this.C?5==this.C.error:!1;this.H=new Ls("",new RW,this.Ba());this.Xa(this.H);this.J=new Ls("",new SW,this.Ba());this.Xa(this.J)}w(jX,VW);p=jX.prototype;p.Ia=function(){jX.$.Ia.call(this);this.ZD()&&osc(this).appendChild(T(Btc))};
p.Wa=function(){jX.$.Wa.call(this);pq(this.Ma,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().R(this.H,"action",this.E0b);if(this.ZD()){var a=this.cb("waffle-assistant-answers-card-remove");this.J.ob(a);TW(a,"Remove card",0);this.getHandler().Ic(this.J,"action",this.F0b)}};p.YL=function(){return wb([Ktc,kX],this.F)?2799:wb([Ltc,Mtc],this.F)?2801:null};p.XL=function(){return wb([Ktc,kX],this.F)?2798:wb([Ltc,Mtc],this.F)?2800:null};p.r$=n("Were these interesting?");
p.Oma=n("Interesting");p.Nma=n("Not interesting");p.dG=n("assistantAnswersFeedback");p.ZD=function(){return this.C?!$sc(this.C):!1};p.sI=function(){var a=this.F.title;a&&this.C?mq(this.Ma,a+(" for question : "+this.C.C)):mq(this.Ma,"Suggested questions")};
p.yI=function(a){var b=this;this.Ga.then(function(c){if(c.length){var d=b.Ba(),e=WW(b);if(!d.ai(e).length){var f=T(Jtc,{title:b.F.title,xVb:pb(c,function(a){return a.query}),o9:b.C?gtc(b.C):"",showHelp:b.L});e.appendChild(f);var h=pb(c,function(a){return a.type}),e=b.Ti("waffle-assistant-answercard-question-container");z(e,function(a,e){var f=new Ls("",new SW,d);b.Xa(f);f.ob(a);b.getHandler().R(f,"action",u(b.WDb,b,c[e],h,e))});b.L&&b.H.ob(b.cb("waffle-assistant-answers-helpcenter-link"))}}else O(b.Ma,
!1);a()})};p.F0b=function(){otc(this.Z,!1);this.dispatchEvent(new G("rc"))};p.WDb=function(a,b,c){this.dispatchEvent(new ptc(this.F.V3,a.Cq||null,b,c,this.F.rZ,a.query))};p.E0b=function(){Q.Go.Dc()};var Ntc={title:"",rZ:0,V3:null},Ktc={title:"",rZ:5,V3:1},kX={title:"Suggested questions",rZ:5,V3:1},Mtc={title:"Did you mean?",rZ:2,V3:4},Ltc={title:"Related questions",rZ:4,V3:4};function Otc(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function lX(a){return Otc(a,1)[0]}function Ptc(a){var b=0;z(a,function(c,d){c.length>a[b].length&&(b=d)});return pb(a[b],function(b,d){return pb(a,function(a){return a[d]})})};function Qtc(a){this.F=[];this.D={};this.J=a;this.C=new wO}function Rtc(a,b,c,d){function e(a){return a.toLowerCase()}Kb(b,void 0,e);Kb(c,void 0,e);Kb(d,void 0,e);z(b,a.H,a);z(c,a.H,a);z(d,a.H,a)}Qtc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(!d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function Stc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}Qtc.prototype.WH=function(a,b,c){if(Pa(a||"")){var d=this.J.Km();d=Ttc(this,a.substring(0,d));var e=Utc(this,b-d.length,a);d=Gb(d,e)}else d=Utc(this,b);d.length>b&&(d=Jb(d,0,b));c(a,d)};
function Utc(a,b,c){var d=c||"";c=Ub(a.D,function(a){return Ja(a,d)});var e=Vtc(Zb(c),d?1:2,1);a=ob(a.F,function(a){return Ja(a.query,d)&&!e[a.query.toLowerCase()]});b=Vtc(a,b-Yb(e),2);b=Zb(b);var f=pb(b,function(a,b){a.Uua=b;return a.AWa});z(b,function(a){a.Sua=f});return Gb(b,Zb(e))}
function Ttc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={sea:h.sea,u2:h.u2,oU:h.oU},++k)if(!k||" "==f[k-1]&&" "!=f[k]){h.oU={};h.u2=0;h.sea=f.substr(k);var l=a.C.Oe(h.sea);z(l,function(b){return function(c){var d=c.length-b.sea.length;b.u2=Math.max(d,b.u2);c=a.C.get(c);b.oU[d]||(b.oU[d]=[]);Ib(b.oU[d],c)}}(h));for(l=0;l<=h.u2&&0<d;++l){var m=h.oU[l];if(m)for(var q=0;q<m.length&&0<d;++q){var r=m[q];Va(b.toLowerCase(),r.toLowerCase())||e[r]||(--d,c.push({text:r,Cq:"",sA:0,
rDa:f.length-k,AWa:void 0,Sua:[],Uua:-1}),e[r]=!0)}}}return c}function Vtc(a,b,c){b=Otc(a.length,Math.min(a.length,b));var d={};z(b,function(b){b=a[b];var e=va(b)?b:b.query;d[e.toLowerCase()]={text:e,Cq:va(b)?"":b.Cq,sA:c,rDa:0,AWa:va(b)?void 0:b.type,Sua:[],Uua:-1}});return d};function mX(){QI.call(this,"",null,!1)}w(mX,QI);mX.prototype.sD=function(a,b){if(2==a.sA||1==a.sA)return mX.$.sD.call(this,a.text,b);var c=this.$a(),d=this.Km(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.rDa)+a.text;e||(f+=" ");a=mX.$.sD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.pk;b.blur();b.focus();this.x3(f.length);return a};
mX.prototype.Lg=function(a){var b=mX.$.Lg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,lnb(b)&&b.wG()&&a.preventDefault(),b=!0);return b};function Wtc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(fu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(fu({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(fu({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function Xtc(a){this.wb=a||Km()}
Xtc.prototype.iA=function(a,b,c){b=T(Wtc);var d=this.wb.cb("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.wb.Df(d,a.text);var d=this.wb.cb("waffle-assistant-answers-ac-entity-icon",b),e=this.wb.cb("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.wb.cb("waffle-assistant-answers-ac-session-query-icon",b);O(d,0==a.sA);O(e,2==a.sA);O(f,1==a.sA);d="";switch(a.sA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&pq(c,d);this.wb.appendChild(c,b)};function Ytc(a){var b=a.type;if(!t(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return t(a.value)?a.value:null}}
function Ztc(a,b){var c=a.type;if(t(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(va(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":va(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function $tc(){var a=Lr("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(fu({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function nX(a,b,c,d,e,f,h,k,l,m,q){$W.call(this,q);this.uf=c;this.Eg=d;this.$f=e;this.De=a;this.xb=h;this.Ja=m;this.Sa=this.O=this.J=this.Wb=null;this.Ga=new mX;this.Ga.dIa=!0;this.Ga.Pa=!0;this.Za=new Qtc(this.Ga);a=new OI(null,new Xtc(q));this.H=new MI(this.Za,a,this.Ga);this.Ca(this.H);this.Kb=f;this.gb=this.Pa=this.F=null;this.qb=k;this.le=this.Mb=!1;this.jb=qj(new pj,10).build();this.Ee=new Rg;this.Vb=l;this.qa={};this.V=this.Jc=this.D=this.zc=null;this.Yd=pi();this.Qb="";this.bb=null}w(nX,$W);
p=nX.prototype;p.Ia=function(){nX.$.Ia.call(this);var a=this.H.ue();a.className="waffle-assistant-answers-ac-renderer";a.JN="waffle-assistant-answers-ac-row";a.g7="waffle-assistant-answers-ac-active";a.zpa="waffle-assistant-answers-ac-highlighted"};p.Wa=function(){nX.$.Wa.call(this);this.Ga.C=this.H;this.H.cZ=!1;this.H.fca=6;this.getHandler().R(this.H,"update",this.Slb);this.hI(!this.F)};
p.Ysa=function(a,b){nX.$.Ysa.call(this,a,b);b=this.Ba();var c=this.Z;b.appendChild(a,T($tc));this.Jc=b.cb("waffle-assistant-answers-input",a);this.V=b.cb("waffle-assistant-answers-query-box",a);this.J=new Ls("",new SW,this.Ba());c.Xa(this.J);this.J.ob(b.cb("waffle-assistant-answers-clear-query-button",this.V));this.Sa=new $V(!1,"#4285f4");c.Xa(this.Sa);this.zc=b.cb("waffle-assistant-answers-spinner-container",this.V);this.Sa.render(this.zc);this.D=b.cb("waffle-assistant-answers-input-box",this.V);
xnb(this.Ga,this.D);TW(this.J.getElement(),"Clear query");c.getHandler().R(this.V,"submit",u(this.FFb,this)).R(this.V,"focus",u(this.eHa,this,!0),!0).R(this.V,"blur",u(this.eHa,this,!1),!0).R(this.J,"action",u(this.f7a,this)).R(this.D,"input",u(this.GWb,this)).R(this.D,"focus",u(this.$Ta,this));this.J.setVisible(!1)};p.t8=function(){znb(this.Ga,this.D);this.J.setVisible(!1);this.Sa.dispose();this.Sa=null;nX.$.t8.call(this)};
p.hI=function(a){var b=this;if(this.Jc){O(this.Jc,!a);var c=Ev;c&&c.dispatchEvent("resize")}a?(this.bb&&this.bb.dispose(),this.bb=new Cl(function(){nX.$.hI.call(b,a)},300,this),this.Ca(this.bb),this.bb.start()):(this.bb&&this.bb.stop(),nX.$.hI.call(this,a))};p.lh=ca("Wb");
function auc(a,b,c,d){var e=pb(wc(c,1),function(a){return a.getName()}),f=[],h=[];z(wc(c,2),function(a){f.push(a.getName());h=h.concat(wc(a,2))});Rtc(a.Za,e,f,h);buc(a.De).then(function(a){this.Za.F=a;Bn(this.Ba())==this.D&&this.$Ta()},null,a);e=a.F&&a.Pa&&b&&d&&(!a.F.equals(b)||!a.Pa.equals(d));a.F=b;a.Pa=d;a.gb=c;if(e&&$n)for(c=pb(a.C,function(a){if(a instanceof gX||a instanceof iX)return a.yO().C}),a.wZ(),d=0;d<c.length;d++)if(e=c[d]){var k=new GW;M(k,1,5);oX(a,k,void 0,e)}a.hI(!b)}
p.reset=function(){hU(this.qa);hU(this.Za.D);var a=this.Za;a.F=[];a.C.clear();this.O=null};p.Slb=function(a){if(a.row)if(a=a.row,2==a.sA){var b=qtc(1,a.Sua,a.Uua,2);oX(this,b,a.Cq);this.Kb.fc(2652,this.jb)}else 0==a.sA?(this.Mb=!0,this.Kb.fc(2651,this.jb)):1==a.sA&&(a=new GW,M(a,1,3),oX(this,a))};p.eHa=function(a){tq(this.V,"waffle-assistant-answers-query-box-focused",a);this.H.Of()&&!a&&this.H.Ij()};p.GWb=function(){this.J.setVisible(!!Ytc(this.D))};
p.$Ta=function(){this.H.yw(this.D);var a=cb(Ytc(this.D));this.Ga.x3(a.length);inb(this.H,a||"  ");this.H.update(!0)};
function oX(a,b,c,d){var e=a.Ja.L.Ps();M(b,13,e);e=new HW;cj(e,5,b);d=d||Pa(Ytc(a.D));if(!a.Wb||3<=a.Wb.getStatus().getState().C)if(a.qa[d])cuc(a,d,!1);else{c=new cX(d,null,null,null,2,a.Ja);duc(a,c,!0,e);return}else{var f=a.qa[d];f&&f instanceof iX&&2==f.yO().error&&delete a.qa[d]}if(d&&a.F)if(a.qa[d])a.Kb.fc(2681,a.jb),cuc(a,d,!0);else{var f=euc(),h=aj(aj(f,FT,46),HW,4);M(h,2,a.Mb);f=rj(qj(new pj,10),f).build();a.Kb.fc(2635,f);a.Mb=!1;f=zw(a.F.rect);b=xl(Jk(yl(Lk(Mk(a.Wb.Qf("/answers/parse").Wf("q",
d,"qt",L(b,1),"gid",a.F.Xc,"range",f),u(a.Ok,a,d,e)),u(a.z0b,a,d,e)),"POST"),2));$n&&a.Pa&&(e=a.Pa.rect.width&&a.Pa.rect.height?zw(a.Pa.rect):"",b.Wf("headerRange",e));c&&b.Wf("sgfml",c);b.Ze();a.Qb=qi(a.Yd,ok.Lwa);fuc(a,!0)}else Ztc(a.D,"");a.D.blur();a.J.setVisible(!!d);a.H.Of()&&a.H.Ij()}function cuc(a,b,c){var d=a.qa[b];d!=lb(a.C)&&(1<a.C.length&&guc(a),c&&huc(a,d.yO()).then(function(a){iuc(this,d,a)},null,a),Qsc(a,d))}
p.FFb=function(a){a.stopPropagation();a.preventDefault();a=new GW;M(a,1,2);oX(this,a)};p.f7a=function(){Ztc(this.D,"");this.J.setVisible(!1)};p.z0b=function(a,b){if(this.F){var c=L(aj(b,GW,5),1),c=1==c||4==c?Frc.pBa:Frc.MBa,d=euc(),e=aj(aj(d,FT,46),HW,4);M(e,1,c);M(b,1,c);c=rj(qj(new pj,10),d).build();this.Kb.fc(2640,c);juc(this,a,b)}};function juc(a,b,c){fuc(a,!1);b=new cX(b,null,null,null,3,a.Ja);duc(a,b,!1,c);kuc(a)}
p.Ok=function(a,b,c){this.F&&this.qb.C.D.ye.then(function(){var d=null,e=null,f=!1,h=aj(b,GW,5),k=L(h,1),l=euc(),k=1==k||4==k?Frc.pBa:Frc.MBa,m=aj(aj(l,FT,46),HW,4);M(m,1,k);M(b,1,k);l=rj(qj(new pj,10),l).build();if(c.ql()){e=this.Ee.cd(KW.Ra(),c.og());if(f=e.getStatus()){switch(f){case 1:var q=2639;break;case 2:q=2643;break;case 3:q=2644;break;case 4:q=2638;break;case 5:q=2707;break;case 6:q=2706}q&&this.Kb.fc(q,l)}q=B(e,10);M(h,4,q);q=B(e,11);M(h,5,q);rc(e,16)&&(q=B(e,16),M(h,16,q));if(1==f){juc(this,
a,b);return}if(2==f){e=-1!=luc(a);h=-1!=Ysc(a);f=4;d=aj(b,GW,5);e?(f=5,M(d,8,2)):h&&(f=7,M(d,8,1));h=new cX(a,null,null,null,f,this.Ja);e?(e=new iX(h,!0,this.Vb,!0,this.Ba()),muc(this,h,e,b)):duc(this,h,!0,b);fuc(this,!1);kuc(this);return}q=rc(e,2)?B(e,2):null;f=!0;if(q){k="";d=nuc(this.qb,q,this.F,!!this.gb&&!!B(this.gb,4));M(h,14,!!d);if(!d){if(m=q.match(/([A-Z]*)\(/)){var r=aj(aj(l.C?aj(l.C,hj,4):null,FT,46),HW,4);M(r,7,m[1]);M(b,7,m[1])}this.Kb.fc(2645,l)}d&&ouc(d)||(l=this.qb,r=this.F,k="="!=
q[0]?"="+q:q,m=puc(l),r=quc(m,r),k=aBb(l.C,k,m,r.row,r.zj));l=rc(e,19)?nuc(this.qb,B(e,19)||"",this.F,!!this.gb&&!!B(this.gb,4)):d;d=new cX(a,d,"="!=q[0]?"="+q:q,e,null,this.Ja,l);k&&d.L.push(k);d.Pm()&&(q=ctc(d),l=new Arc,q&&(l=utc(q)),M(l,1,d.F),cj(h,15,l))}else rc(e,9)&&(q=e.getError(),d=new cX(a,null,null,e||null,6,this.Ja),l=B(q,2),M(h,6,l),rc(q,3)&&(q=B(q,3),M(h,12,q)))}else this.Kb.fc(2640,l);d||(d=new cX(a,null,null,e||null,4,this.Ja));fuc(this,!1);$sc(d)?ruc(this,d,f,b):duc(this,d,f,b);kuc(this)},
function(){juc(this,a,b)},this)};function kuc(a){""!=a.Qb&&(ri(a.Yd,a.Qb),a.Qb="")}function suc(a){if(null!=a.Cq)return Ltc;switch(a.error){case 4:case 6:return 0<a.O.length?Mtc:kX;case 5:return kX}return Ntc}function euc(){var a=new HW;M(a,8,Pva);var b=new FT;cj(b,4,a);a=new hj;cj(a,46,b);return a}function luc(a){return vb(Wsc,function(b){return Ja(a,b)})}
function tuc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=B(b[d],2),f=!!a.gb&&!!B(a.gb,4),e=nuc(a.qb,e,a.F,f);ouc(e)&&(e={query:B(b[d],1),Cq:B(b[d],2),type:b[d].getType()},rc(b[d],5)&&(e.$Ha=B(b[d],5)),c.push(e))}return yj(c)}function ruc(a,b,c,d){c=new gX(b,a.uf,a.Eg,a.$f,a.Kb,a.Vb,a.xb,c,a.Ja,a.le,a.Ba());muc(a,b,c,d)}function duc(a,b,c,d){c=new iX(b,c,a.Vb,!1,a.Ba());muc(a,b,c,d)}
function muc(a,b,c,d){guc(a);var e=huc(a,b,d);uuc(a,c);vuc(a);$sc(b)&&Stc(a.Za,b.C);e.then(function(a){if(d){var b=euc(),e=aj(b,FT,46);cj(e,4,d);b=rj(qj(new pj,10),b).build();this.Kb.fc(2781,b)}iuc(this,c,a)},null,a);c.Yla()&&(a.qa[b.C]=c);a.getHandler().R(c,"rc",a.vNa)}function iuc(a,b,c){b instanceof iX&&c&&jp(c.getElement())&&(b=b.getElement(),O(b,!1),a.getHandler().R(c,"rc",a.vNa))}function guc(a){wuc(a);z(a.C,function(a){a instanceof iX&&(a=a.getElement(),O(a,!0))});xuc(a)}
function xuc(a){a.C.length&&(a.O?Qsc(a,a.O):(a.O=new Itc(a.Ba()),uuc(a,a.O)))}function wuc(a){z(a.C,function(b){b instanceof gX||b instanceof iX||b==a.O||a.RH(b)})}
function huc(a,b,c){var d=suc(b),e=null;d==Ltc||d==Mtc?0<b.O.length&&(e=tuc(a,b)):d==kX&&(e=yuc(a.De));var f=null;return e?(f=new jX(new LV,a.Vb,e,d,b,a.Ba()),uuc(a,f),a.Kb.fc(2769,a.jb),a.getHandler().R(f,"sqc",u(a.VDb,a)),e.then(function(a){if(c){var b=aj(c,GW,5);wb([Ltc,Mtc],f.F)?(a=stc(a),cj(b,7,a)):wb([Ktc,kX],f.F)&&(a=ttc(a),cj(b,9,a))}return f},null,a)):yj(f)}
p.VDb=function(a){Ztc(this.D,a.J);this.D.focus();var b=a.V,b=1==b?qtc(b,a.C,a.F,3):rtc(b,a.C,a.F,a.Z);oX(this,b,a.L);this.Kb.fc(2762,this.jb)};function fuc(a,b){O(a.zc,b);O(a.Ba().cb("waffle-assistant-answers-button-container",a.V),!b);a.Sa&&a.Sa.setActive(b)}function uuc(a,b){b.hf(a.Fd());a.C.push(b);a.Xe&&(a.L.Yh(b,0,!0),b.xK());qsc(b,!0)}function vuc(a){for(var b=a.C;5<b.length;)a.RH(b[0])}p.wZ=function(){nX.$.wZ.call(this);this.reset()};
p.vNa=function(a){var b=this,c=this.Ba();a=a.target;if(a instanceof gX)this.RH(a),hX(this.xb,"Answer removed",c,u(this.QAb,this,a));else if(a instanceof iX)this.RH(a),hX(this.xb,"Card removed",c);else if(a instanceof jX&&a.C&&!$sc(a.C)){var d=a.C.C;z(this.C,function(a){a instanceof iX&&a.yO().C==d&&(b.RH(a),hX(b.xb,"Card removed",c))})}a=this.C;!this.O||a[0]!=this.O&&a[a.length-1]!=this.O||(this.RH(this.O),this.O=null)};
p.QAb=function(a){ruc(this,a.yO(),a.Yla());hX(this.xb,"Remove answer undone",this.Ba())};p.RH=function(a){if(a.wc()){if(a instanceof gX||a instanceof iX)delete this.qa[a.yO().C],a==lb(this.C)&&wuc(this);nX.$.RH.call(this,a)}F(a)};function zuc(a,b){this.C=a;this.D=b}function nuc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=puc(a);c=quc(e,c);(a=prc(a.C,b,e,c.row,c.zj))&&d&&a.length<a[0].length&&(a=Ptc(a));return a}function ouc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function puc(a){a=aw(a.D);return null!=a?a.toString():"0"}
function quc(a,b){var c={row:0,zj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Kc()+1?c.row=b.Kc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Rc()+1&&(c.zj=b.Rc()+1));return c};function Auc(a){var b=[];if(rc(a,25)&&(a=B(a,25)))for(var c=0;c<sc(a,1);c++){var d=B(a,1,c);if(rc(d,2)){var e=B(d,2);e&&b.push(Buc(e,Cuc(d)))}}return b}function Duc(a){var b=Auc(a);rc(a,6)&&(a=B(a,6))&&b.push(Buc(a,0));return b}function Cuc(a){return(a=rc(a,4)?B(a,4):0)?a:0}function Buc(a,b){return{name:a,a5a:b}};function Euc(a,b,c){this.Ga=a;this.Ja=b;this.D=[];this.F=[];this.L=[];this.O=[];this.V=[];this.Z=[];this.C=new yd;this.J=new yd;this.qa=new yd;this.H=new yd;Fuc(this,c)}function Guc(a,b){return zd(a,b)?a.get(b).values.jd():[]}
function Fuc(a,b){for(var c=new Ed,d=new Ed,e=0;e<b.length;e++){for(var f=Duc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(zd(a.Ga,m)){var q=a.Ga.get(m);c.add(q);h.push(q)}zd(a.Ja,m)&&(m=a.Ja.get(m),d.add(m),k.push(m))}Huc(a,h,k)}a.D=c.jd();a.F=d.jd();Nb(a.D);Nb(a.F);a.L=pb(a.C.jd(),function(a){return a.key});Nb(a.L);a.O=pb(a.J.jd(),function(a){return a.key});Nb(a.O);a.V=pb(a.qa.jd(),function(a){return a.key});Nb(a.V);a.Z=pb(a.H.jd(),function(a){return a.key});Nb(a.Z)}
function Huc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)pX(a.C,b[d],b[e]),pX(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)pX(a.J,b[d],c[e]),pX(a.qa,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)pX(a.H,c[b],c[d]),pX(a.H,c[d],c[b])}function pX(a,b,c){var d;zd(a,b)?d=a.get(b).values:d=new Ed;d.add(c);a.set(b,{key:b,values:d})};function Iuc(a,b){this.C=a;for(var c=new yd,d=0;d<a.Gk();d++)c.set(a.Dd(d).getName().toLowerCase(),d);this.O=c;c=new yd;for(d=0;d<sc(a,1);d++)c.set(B(a,1,d).getName().toLowerCase(),d);this.Ga=c;c=[];for(d=0;d<a.Gk();d++)qX(a.Dd(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<sc(a,1);d++)qX(B(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<sc(a,1);d++){for(var e=B(a,1,d).getName(),f=!0,h=0;h<Juc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Juc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Ja=
c;this.qa=Kuc(a,0);this.V=Kuc(a,1);c=[];for(d=0;d<a.Gk();d++).8<=B(a.Dd(d),6)&&c.push(d);this.Z=c;c=[];for(d=0;d<a.Gk();d++)e=a.Dd(d),.95<=wc(e,2).length/B(e,8)&&c.push(d);this.Sa=c;c=[];for(d=0;d<sc(a,3);d++)f=a.Dd(B(a,3,d)),e=wc(f,2).length/B(f,8),f=sc(f,3)/sc(f,2),.5<e||.3>f||c.push(B(a,3,d));this.Pa=c;this.F=Luc(a.Gk());this.H=Luc(sc(a,1));this.D=new Euc(this.O,this.Ga,b)}function Luc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}
function Kuc(a,b){for(var c=[],d=0;d<a.Gk();d++)a.Dd(d).getType()==b&&c.push(d);return c}function Muc(a,b){if(!a.length&&!b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Nuc(c,a[d]);for(a=0;a<b.length;a++)d=Nuc(c,b[a]),c=0<d.length?d:c;return 0<c.length?c[lX(c.length)]:-1}function rX(a,b,c,d,e,f){var h=[a.J,a.D.D],k=[a.F];b&&(k.push(a.qa),k.push(a.Z));c&&k.push(a.Pa);d&&k.push(a.Sa);null!=f&&-1!=f?h.push(Guc(a.D.J,f)):e&&h.push(a.D.O);return Muc(k,h)}
function sX(a,b,c){var d=[a.L,a.D.F],e=[a.H];b&&e.push(a.Ja);c&&d.push(a.D.V);return Muc(e,d)}function Ouc(a,b){for(var c=5;;){var d=a.C.Dd(b),e=lX(sc(d,2));c--;if(qX(FW(d,e))||!c)return e}}function Puc(a,b){for(var c=5;;){var d=a.C.Dd(b),e=lX(sc(d,3)),e=B(d,3,e);c--;if(qX(FW(d,e))||!c)return e}}function tX(a,b){b=a.C.Dd(b);a=b.getName();qX(a)||(b=Quc(wc(b,7)),a=null==b?a:b);return a}function uX(a,b){b=B(a.C,1,b);a=b.getName();qX(a)||(b=Quc(wc(b,2)),a=null==b?a:b);return a}
function Quc(a){for(var b=0;b<a.length;b++)if(qX(a[b]))return a[b];return null}function qX(a){return null==a?!1:50>=a.length}function Ruc(a){for(var b=Otc(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}function Nuc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Juc=["average","total","sum","mean","median"];function Suc(a,b){this.C=[];this.F=[];this.H=this.V=this.J=this.D=null;this.O=new Ed;this.L=new Ed;this.Z=a;this.Kb=b;this.qa=qj(new pj,10).build()}Suc.prototype.reset=function(){this.C=[];this.F=[];this.D&&(this.D.cancel(),this.D=null);this.L=new Ed;this.O=new Ed};Suc.prototype.lh=ca("H");function buc(a){return vva&&a.D?a.D.then(function(){return this.F.slice()},null,a):yj(a.C.slice())}function Tuc(a){Nb(a,function(a,c){return c.weight-a.weight});return pb(a,function(a){return a.Tua})}
function Uuc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}function vX(a,b,c,d,e){e=Math.pow(Math.random(),1/(Uuc(d)*(void 0===e?1:e)));a.L.contains(c)||(b.push({Tua:{query:c,Cq:void 0,type:d},weight:e}),a.O.add(d),a.L.add(c))}
function wX(a,b){return!a.O.contains(b)}function yuc(a){return buc(a).then(function(a){return 3>=a.length?a:Jb(a,0,3)},null,a)}function Vuc(a,b){var c=[];b=Auc(b);for(var d=0;d<b.length&&-1!=a.Ga.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}function Wuc(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=Xuc;break a;case 4:a=Yuc;break a}a=Zuc}return a[lX(a.length)]}
function $uc(a){var b=null;a.D=new wj(function(a){if(!this.H||3<=this.H.getStatus().getState().C)this.F=this.C,a();var c=zw(this.J.rect),e=pb(this.C,function(a){return a.query});b=yl(xl(Jk(Lk(Mk(this.H.Qf("/answers/parsesuggestions").Wf("gid",this.J.Xc,"range",c),u(function(b){avc(this,b).then(a)},this)),u(function(b){8==b.errorCode&&this.Kb.fc(2833,this.qa);this.F=this.C;a()},this)).setContent(["queries",Ui(e)]).setTimeout(2E3),1)),"POST").Ze()},a);Dj(a.D,function(){b&&b.dispose()})}
function avc(a,b){return a.Z.C.D.ye.then(function(){var a=[];if(b.ql())for(var d=b.og(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.V&&!!B(this.V,4),f=nuc(this.Z,d[e],this.J,f),f=ouc(f);f&&(this.C[e].Cq=d[e],a.push(this.C[e]))}this.F=a},function(){this.F.length=0},a)}var bvc="Minimum Maximum Most Least Highest Lowest".split(" "),cvc=["Top","Bottom"],Zuc=["Average","Median"],Xuc=["Total","Average","Median"],Yuc=["Median"],dvc=["before","after"];function evc(){var a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(fu({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+Pr("Ask a question about your data")+'" /></div></form></div>');return V(a)};function xX(a,b,c,d,e,f,h,k){aX.call(this,1,f,e,k);this.qb=c;this.Ga=null;this.qa=new Ls("",new RW,this.Ba());this.Xa(this.qa);this.Ja=new Ls("",new RW,this.Ba());this.Xa(this.Ja);a=new YAb(a,!0,!0);a=new zuc(a,c);this.gb=new ntc(e);this.O=new Suc(a,e);this.L=new nX(this.O,0,b,c,d,e,this.bb,a,this.gb,h,k);c=fvc;this.D=new vtc(b,c.S0a,c.T0a);this.Ca(this.D);this.F=this.H=null;this.jb=qj(new pj,10).build()}w(xX,aX);
var fvc={S0a:"waffle-assistant-answers-styled-border",T0a:"waffle-assistant-answers-styled-rect",d1a:"waffle-assistant-answers-input-box",D2a:"waffle-assistant-answers-query-box",ksc:"waffle-assistant-answers-query-box-focused",t1a:"waffle-assistant-answers-learn-more",fnc:"waffle-assistant-answers-logging-message-container",h2a:"waffle-assistant-answers-logging-opt-out"};p=xX.prototype;p.Ia=function(){xX.$.Ia.call(this);var a=T(evc);this.Ba().appendChild(Ssc(this),a)};
p.Wa=function(){xX.$.Wa.call(this);var a=fvc,b=this.cb(a.D2a),c=this.cb(a.d1a);this.Ja.ob(this.cb(a.h2a));this.qa.ob(this.cb(a.t1a));this.getHandler().R(b,"focus",this.eAb,!0).R(b,"blur",this.cAb,!0).R(b,"mouseover",this.gAb).R(b,"mouseout",this.fAb).R(b,"click",this.dAb).R(c,"input",this.A0b).R(this.Ja,"action",this.Byb).R(this.qa,"action",this.ivb).R(ew(this.qb),"Da",Clc(this.B0b,25,this));this.setVisible(!!this.H);gvc(this,uva&&xva&&ao("showAnswersLoggingOptOut"))};p.GVa=fd;p.jOa=gd;p.cua=fd;
p.D4=n("Answers");p.ewa=n(1);p.Via=function(a){return 3==a||0==a};p.dwa=function(a,b){Nb(a,function(a,b){return B(b,2)-B(a,2)});for(var c=[],d=null,e=0;e<a.length;e++){var f=xc(a[e],1);3==f?d=a[e]:0==f&&c.push(B(a[e],8))}d&&B(d,2)?(e=b||null,f=0==B(d,11)?uT(B(d,10)):null,0<sc(d,4)?hvc(this,uT(B(d,4,0)),B(d,9),f,c):hvc(this,e,B(d,9),f,c),this.F||(xX.$.dwa.call(this,a,b),this.getHandler().R(this.F,"sqc",this.UDb))):this.dW(!0)};
p.e8=function(a){if(!this.F){var b=yuc(this.O);this.F=new jX(a,this.gb,b,Ktc,void 0,this.Ba())}return this.F};p.iEa=g("L");p.npa=function(){return this.mb()};
p.dW=function(a,b,c){this.O.reset();(a||b)&&this.F&&(xX.$.dW.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||t(b)&&!b)this.F&&(xX.$.dW.call(this,a,b,c),this.F.dispose(),this.F=null),this.wc()&&(this.O.reset(),this.H=null,a=this.L,a.wc()&&(b=a.Za,b.F=[],b.C.clear(),a.D&&Ztc(a.D),a.wZ(),a.F=null,a.hI(!0),a.J&&!a.J.isDisposed()&&a.J.setVisible(!1),a.Mb=!1),this.setVisible(!1),this.Zb()&&eX(this.D));c&&this.L.reset()};p.lh=function(a){this.Ga=a;this.L.lh(a);this.O.lh(a)};
p.setActive=function(a){xX.$.setActive.call(this,a);a?dX(this.D,this.H):eX(this.D)};function ivc(a,b){a.Zb()&&(b?eX(a.D):dX(a.D,a.H))}function gvc(a,b){O(a.cb("waffle-assistant-answers-logging-message-container"),b)}function jvc(a,b){a=a.cb("waffle-assistant-answers-query-box");tq(a,"waffle-assistant-answers-query-box-focused",b)}p.B0b=function(){this.Zb()&&dX(this.D,this.H)};p.eAb=function(){jvc(this,!0);dX(this.D,this.H)};p.cAb=function(){jvc(this,!1);this.Zb()||eX(this.D)};
p.gAb=function(){dX(this.D,this.H)};p.fAb=function(){this.Zb()||eX(this.D)};p.dAb=function(){kvc(this,"")};p.A0b=function(){var a=this.cb("waffle-assistant-answers-input-box");kvc(this,a.value);a.value=""};p.UDb=function(a){var b=this;kvc(this,a.J);var c=qtc(1,a.C,a.F,1),d=new Cl(function(){oX(b.L,c,a.L)},300);this.Ca(d);d.start();this.ju().fc(2652,this.jb)};
function kvc(a,b,c){a.setActive(!0);a.dispatchEvent("re");var d=new Cl(function(){var d=a.L;Ztc(d.D,b);d.D.focus();a.L.le=c||!1},300);a.Ca(d);d.start()}
function hvc(a,b,c,d,e){var f=c||new IV;a.H=b;var h=a.O,k=e;h.reset();var k=wva?k:[],l=[],m=new Iuc(f,k);if(wva)for(var q=k,r=0;r<q.length;r++){var v=q[r];switch(v.getChartType()){case "BarChart":var x=h,y=m,C=l;if(wX(x,13)||wX(x,2)){var K=B(v,6);if(K&&-1!=y.O.get(K.toLowerCase(),-1)){var N=Vuc(y,v);1<N.length&&(Un&&wX(x,23)?vX(x,C,"Scatter chart of "+N[0].name+" vs "+N[1].name,23,2):wX(x,2)&&vX(x,C,"Correlation of "+N[0].name+" and "+N[1].name,2,1.5))}}break;case "ScatterChart":var R=h,Z=l,ha=Vuc(m,
v);1<ha.length&&(Un&&wX(R,23)?vX(R,Z,"Scatter chart of "+ha[0].name+" vs "+ha[1].name,23,2):wX(R,2)&&vX(R,Z,"Correlation of "+ha[0].name+" and "+ha[1].name,2,1.5));break;case "PieChart":for(var ja=h,qa=l,ya,za=[],Qa=Auc(v),gb=0;gb<Qa.length&&-1!=m.O.get(Qa[gb].name.toLowerCase(),-1);gb++)za.push(Qa[gb]);ya=za;1==ya.length&&4==ya[0].a5a&&(Un&&wX(ja,20)?vX(ja,qa,"Bar chart of distribution of "+ya[0].name,20,2):wX(ja,14)&&vX(ja,qa,"Distribution of "+ya[0].name,14,1.5))}}if(wX(h,1)){var ab=m.C,Za=sX(m,
!1,!0),tb=rX(m,!0,!1,!0,!0,Za);if(-1!=tb&&-1!=Za){var fc=10<=sc(ab.Dd(tb),2)?"5 ":"",dd=tX(m,tb),bd=uX(m,Za);dd!=bd&&vX(h,l,cvc[lX(cvc.length)]+" "+fc+dd+" by "+bd,1)}}if(wX(h,2)&&1<sc(m.C,1)){a:if(2>m.H.length)var Cd=[-1,-1];else{var Ae=Muc([m.H],[m.L,m.D.F,m.D.Z]);if(-1!=Ae){var zb=Guc(m.D.H,Ae);if(0<zb.length){var ae=[Ae],Bb=lX(zb.length);ae.push(zb[Bb]);Cd=ae;break a}}Cd=Ruc(2<=m.L.length?m.L:m.H)}var Mc=Cd,be=uX(m,Mc[0]),Jf=uX(m,Mc[1]);be!=Jf&&vX(h,l,"Correlation of "+be+" and "+Jf,2)}if(wX(h,
3)){var di=m.C,ei=sX(m,!0);-1!=ei&&vX(h,l,Wuc(wc(B(di,1,ei),3))+" of "+uX(m,ei),3)}if(wX(h,5)){var xi=m.C,Ng=sX(m,!0,!0),fl=rX(m,!0,!0,!1,!0,Ng);if(-1!=Ng&&-1!=fl){var Zp=uX(m,Ng),Fn=xi.Dd(fl),Zs=tX(m,fl);if(0<sc(Fn,3)&&Zs!=Zp){var yr=Puc(m,fl);vX(h,l,Wuc(wc(B(xi,1,Ng),3))+" of "+Zp+" when "+Zs+" is "+FW(Fn,yr),5)}}}if(wX(h,9)){var zr=sX(m,!1,!0),$s=rX(m,!0,!1,!0,!0,zr);if(-1!=$s&&-1!=zr){var No=uX(m,zr),Gn=tX(m,$s);Gn!=No&&vX(h,l,Gn+" with "+bvc[lX(bvc.length)]+" "+No,9)}}if(wX(h,10)&&0<sc(m.C,1)){var rk=
uX(m,sX(m));vX(h,l,bvc[lX(bvc.length)]+" "+rk,10)}if(wX(h,11)){var Cx=m.C,Oo=rX(m,!0,!0,!1,!1,-1);if(-1!=Oo){var um=tX(m,Oo);0<sc(Cx.Dd(Oo),3)&&vX(h,l,"Most frequent "+um,11)}}if(wX(h,12)){var Ql=m.C,yi=sX(m,!0);a:{if(1==m.V.length){var vm=m.V[0];if(!B(m.C.Dd(vm),5)){var pB=vm;break a}}pB=-1}var $p=pB;if(-1!=$p&&-1!=yi){var hv=uX(m,yi),LF=Ql.Dd($p);if(0<sc(LF,2)){var Dx=Ouc(m,$p);vX(h,l,Wuc(wc(B(Ql,1,yi),3))+" of "+hv+" "+dvc[lX(dvc.length)]+" "+FW(LF,Dx),12)}}}if(wX(h,15)){var Ex=m.C,Ek=sX(m,!0),
qB=rX(m,!1,!0,!1,!0,Ek);if(-1!=Ek&&-1!=qB){var Fx=uX(m,Ek),iv=tX(m,qB);if(iv!=Fx){var aq=Ex.Dd(qB);if(2<=sc(aq,3)){var Gx=Otc(sc(aq,3),2);vX(h,l,"Compare "+Wuc(wc(B(Ex,1,Ek),3))+" "+Fx+" for "+iv+" "+FW(aq,B(aq,3,Gx[0]))+" and "+FW(aq,B(aq,3,Gx[1])),15)}}}}if(wX(h,16)){var rB=rX(m,!0,!0,!1,!1);if(-1!=rB){var $K=tX(m,rB);vX(h,l,"List unique values in "+$K,16)}}if(wX(h,17)){var Po=m.C,at=rX(m,!0,!0,!1,!1);if(-1!=at){var Hx=Po.Dd(at),MF=tX(m,at);if(!(1>sc(Hx,3))){var Ar=Puc(m,at);vX(h,l,"What percentage of "+
MF+" is "+FW(Hx,Ar),17)}}}if(wX(h,13)){var jv=m.C,Rl=sX(m,!0,!0),sB=rX(m,!0,!0,!1,!0,Rl);if(-1!=Rl&&-1!=sB){var Ix=uX(m,Rl),tB=tX(m,sB);tB!=Ix&&vX(h,l,Wuc(wc(B(jv,1,Rl),3))+" of "+Ix+" by "+tB,13)}}if(Un&&wX(h,18)){var bt=sX(m);-1!=bt&&vX(h,l,"Histogram of "+uX(m,bt),18,2)}var Br=3>l.length;if((Br||!lX(5))&&wX(h,7)){var ct=m.C,kv=sX(m,!1,!0),Hn=rX(m,!1,!1,!1,!0,kv);if(-1!=Hn&&-1!=kv){var uB=ct.Dd(Hn),dt=tX(m,Hn),NF=uX(m,kv);if(0<sc(uB,2)&&dt!=NF){var vB=Ouc(m,Hn);vX(h,l,"Show "+NF+" for "+dt+" "+
FW(uB,vB),7)}}}if((Br||!lX(5))&&wX(h,8)){var Jx=m.C;a:if(2>m.F.length)var bq=[-1,-1];else{var aL=[m.J,m.D.D,m.D.L],et=[m.F];et.push(m.qa);et.push(m.Z);var ft=Muc(et,aL);if(-1!=ft){var gl=Guc(m.D.C,ft);if(0<gl.length){var Fk=[ft],wB=lX(gl.length);Fk.push(gl[wB]);bq=Fk;break a}}var Cr=Ruc(2<=m.J.length?m.J:m.F);Cr[0]!=ft&&(Cr[1]=Cr[0],Cr[0]=ft);bq=Cr}var Kx=bq,gt=Kx[0];if(1<Jx.Gk()&&-1!=gt){var Lx=Kx[1],lv=Jx.Dd(Lx),JL=tX(m,Lx),KL=tX(m,gt);if(0<sc(lv,2)&&JL!=KL){var vT=Ouc(m,Lx);vX(h,l,"What is "+KL+
" where "+JL+" is "+FW(lv,vT),8)}}}h.C=Tuc(l);h.J=b;h.V=f;vva&&$uc(h);a.setVisible(!!b);auc(a.L,b,f,d);a.Zb()&&dX(a.D,a.H)}p.Byb=function(a){a.stopPropagation();a.preventDefault();this.Ga&&(yl(Lk(Mk(this.Ga.Qf("/answers/logoptout"),u(this.Xvb,this)),u(this.Wvb,this)),"POST").Ze(),this.ju().fc(2663,this.jb))};p.ivb=function(a){a.stopPropagation();a.preventDefault();Us("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};
p.Xvb=function(a){a.ql()&&gvc(this,!1)};p.Wvb=ba();function lvc(a,b,c){H.call(this);this.Wb=a;this.Qb=b;this.Ab=c;this.J=a.C;this.Ee=new Rg;this.bb=cl();this.L=new Wk;this.Vb=this.C=this.F=this.V=this.O=this.Pa=this.qa=null;this.Mb=!1;this.D=null;this.kc=!0;this.gb=this.xb=!1;this.Ib=this.jb=null;this.Z=pi();this.Za=this.Sa="";this.Ga=this.Ja=null;b=this.Wb.L.Ps();this.H=new MV;D(this.H,15,!0);D(this.H,2,bva);a=Eva&&!a.Fd();D(this.H,3,a);D(this.H,4,!0);D(this.H,5,Tn&&(Qva||"en"==PE(b)));D(this.H,6,Ava);D(this.H,7,!0);D(this.H,10,!1);D(this.H,11,Pva);
D(this.H,12,Rva);D(this.H,14,$n);this.qb=-1!=window.location.href.indexOf("eeos=false");a=new J(this);this.Ca(a);a.R(this.Qb,"A",this.M0b)}w(lvc,H);var mvc={w6b:"cu",AZa:"cs",zZa:"ce",D1a:"ls",B1a:"le"};function nvc(a){a.gb=!0;a.L.cancel(!0);a.Pa=null;a.O=null;a.V=null;a.F=null;a.qa&&(a.qa.cancel(!0),a.qa=null)}p=lvc.prototype;
p.update=function(a,b,c){c&&this.C&&!ub(c,function(a){return Eda(a,this.C.rect)},this)||!a&&this.C&&c&&1==c.length&&1==c[0].Jh()&&this.C.rect.contains(c[0])||(this.bb.cancel(!0),a&&nvc(this),this.bb=ovc(),this.bb.addCallback(this.q6a,this),this.bb.addCallback(Ca(this.r6a,b),this))};p.lh=ca("jb");p.M0b=function(){this.qa&&3==this.Qb.getState()&&(this.qa.Yb(),this.qa=null)};function ovc(){var a=null,b=new Wk(function(){null===a||Hj(a)}),a=Gj(function(){b.Yb()});return b}
function pvc(a,b,c,d,e){b&&(a.Za=qi(a.Z,ok.Zxa,!1,qvc(a)));a.Ja=d;a.Ga=e;a.L.cancel(!0);a.L=new Wk;rvc(a);a.L.addCallback(a.P8a,a);b&&(a.L.addCallback(Ca(a.L8a,c),a),a.qb||!a.jb||yx(a.Wb)?(a.L.addCallback(a.w6a,a),a.L.addCallback(a.x6a,a)):a.L.addCallback(a.aib,a),a.L.addCallback(a.K8a,a));Zk(a.L,a.L0b,a)}p.L0b=function(a){this.xb=!0;a instanceof Xk||this.Ab.Hn(Error("Assistant cancelled"),{cause:a})};
p.q6a=function(){var a=this.J.getActiveGrid();if(a){var b=gw(this.J),c=b.ck(),d=svc(this,c||[]),e=svc(this,this.Vb||[]);d&&!e||!d&&!tvc(c,this.Vb)?(this.F=null,this.Mb=!0):this.Mb=!1;this.Vb=c;var f=YB(b).clone();z(b.ck(),function(a){f.Mn(a)});this.D=new Og(a.Jb(),"",f)}else this.D=null};
p.r6a=function(a){this.Sa=qi(this.Z,ok.Yxa,!1,qvc(this));var b=this.J.getActiveGrid(),c=this.D&&this.D.Xc;this.C&&this.C.Xc!=c&&(this.C=null);if(!b||b.Jb()!=c||null===c)return this.D=null;var d=this.J.getActiveGrid().D,b=Pz(d,this.D.rect);b.addCallback(function(){if(!this.J.getActiveGrid()||aw(this.J)!=c)return null;var b=gw(this.J),f=uvc(this,a),h=Mz(b.D,"r"),k=b.Un("r");return!b.Kt(f)||h>=f.qc()&&XQa(b)||k<=f.Kc()&&WQa(b)?(this.dispatchEvent(new G("ls")),Qz(d,f,Zb(Gd),a?void 0:500).addCallback(this.S8a,
this)):f},this);b.addCallback(function(a){var b=this.J.getActiveGrid();return a&&b&&b.Jb()==c&&null!==c?vvc(this,a,gw(this.J)):null},this);b.addCallback(function(b){var d=this.C;b&&3<b.Jh()&&(d=b&&new Og(c,"",b));if(null===d&&null!==this.C||null!==d&&!d.equals(this.C))this.F=this.V=this.O=this.Pa=null;b=null!==d&&d.equals(this.C);if(b=this.gb||this.Mb||!b&&(null===this.O||null!==this.V&&null===this.F))this.kc=this.xb&&this.kc||!this.C||!d||!d.rect.intersects(this.C.rect);var e=null!==d&&d.contains(this.C);
this.C=d;""!=this.Sa&&(ri(this.Z,this.Sa),this.Sa="");b&&pvc(this,a,e,this.Ja,this.Ga)},this);return b};function uvc(a,b){return a.D?ritz_api.AssistantApi.getExploreTableRectForSelection(""+a.D.Xc,a.D.rect.top,a.D.rect.height+a.D.rect.top,a.D.rect.left,a.D.rect.width+a.D.rect.left,b,Jva,Zd):null}
function rvc(a){if(null===a.C||null===a.C.rect||null!==a.Pa)a.L.Yb();else{var b=qi(a.Z,ok.Pwa,!1,qvc(a)),c=a.L;ritz_api.AssistantApi.getAssistantConfidence(""+a.C.Xc,a.C.rect.top,a.C.rect.height+a.C.rect.top,a.C.rect.left,a.C.rect.width+a.C.rect.left,a.Ee.serialize(a.H),function(d){ri(a.Z,b);a.Pa=d+0;c.Yb()})}}p.S8a=function(){this.dispatchEvent(new G("le"))};p.P8a=function(){this.dispatchEvent(new wvc(this.C,this.Pa))};p.L8a=function(a){a=new xvc(a,this.gb);this.gb=!1;this.dispatchEvent(a)};
p.aib=function(){if(null===this.C||null===this.C.rect||null!==this.V&&null!==this.F)return null;F(this.Ib);return 3!=this.Qb.getState()?(this.qa=new Wk,this.qa.addCallback(this.EUa,this),this.qa):this.EUa()};
p.EUa=function(){var a=qi(this.Z,ok.aya,!1,qvc(this)),b=yvc(this),c=b&&!b.JPa,d=this.Ja||Vg(this.C.rect,this.C.Xc),b=ritz_api.AssistantApi.getAssistantRequestProto(d,c?b.rows:[],c?b.Ie:[],this.Ga),b=this.Ee.cd(KV.Ra(),b),c=new Rg;c.hv=!0;var b=Ui(c.serialize(b)),e=new Wk;this.Ib=Lk(Mk(Jk(xl(yl(this.jb.Qf("/explore/getrecommendations").Wf("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=qi(this.Z,ok.$xa,!1,qvc(this));b=zvc(this,b.og());ri(this.Z,c);this.V=wc(b,1);this.F=wc(b,2);this.Ib=null;ri(this.Z,
a);e.Yb()},this),function(){this.V=[];this.F=[];e.Yb()},this).Ze();return e};
p.w6a=function(){function a(){d=null;ritz_api.AssistantApi.continueAssistantRecommendation(this.O)?(this.V=wc(zvc(this,ritz_api.AssistantApi.getAssistantRecommendations(this.O)),1),e.Yb()):d=Gj(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.V)return null;this.O=ritz_api.AssistantApi.newAssistantRecommender(this.Ee.serialize(this.H));this.F=this.V=null;if(this.Ja&&this.Ga){var b=uT(this.Ja),c=uT(this.Ga);ritz_api.AssistantApi.startAssistantRecommendationWithHeader(this.O,
""+b.Xc,b.rect.top,b.rect.height+b.rect.top,b.rect.left,b.rect.width+b.rect.left,c.rect.top,c.rect.height+c.rect.top,c.rect.left,c.rect.width+c.rect.left)}else ritz_api.AssistantApi.startAssistantRecommendation(this.O,""+this.C.Xc,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var d=null,b=u(function(){null!==d&&(Hj(d),this.F=this.V=this.O=d=null)},this),e=new Wk(b),d=Gj(a,5,this);return e};
p.x6a=function(){var a=yvc(this);a&&this.O&&null===this.F&&(this.F=a.JPa?[]:wc(zvc(this,ritz_api.AssistantApi.getAssistantRecommendationsOnlySelection(this.O,a.rows,a.Ie)),2))};p.K8a=function(){this.xb=!1;var a=this.F&&0<this.F.length?this.F:this.V;""!=this.Za&&(ri(this.Z,this.Za),this.Za="");this.dispatchEvent(new Avc(this.C,a||[]))};function zvc(a,b){return a.Ee.cd(JV.Ra(),b)}
function vvc(a,b,c){b=b.clone();Xb(Gd,function(a){for(var d=!0;d&&b;){for(var f=Kd(a),h=0;h<(f?b.width:b.height);h++){var k=me(b,a),l=f?b.hc():b.qc(),k=f?c.If(k,l+h):c.If(l+h,k);if(!eWb(k)&&k.Mr()){d=!1;break}}d&&(Hda(b,-1,a),b.width&&b.height||(b=null))}return!!b},a);return b}function tvc(a,b){return Pb(a,b,function(a,b){return fe(a,b)})}
function yvc(a){var b=a.J.getActiveGrid();if(!b||!a.C||b.Jb()!=a.C.Xc)return null;for(var c=gw(a.J).ck(),c=pb(c,Ca(ee,a.C.rect)),c=ob(c,pa),d=pb(c,function(a){return new Vd(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new Ed,e=new Ed,f=0;f<d.length;f++){for(var h=0;h<d[f].width;h++)e.add(d[f].left+h);for(h=0;h<d[f].height;h++)b.add(d[f].top+h)}a=svc(a,c);return{rows:b.jd(),Ie:e.jd(),JPa:a}}
function svc(a,b){a.J.getActiveGrid();if(!b.length)return!0;if(1!=b.length)return!1;b=b[0];if(ge(b)||!b.Jh())return!0;a=sXa(gw(a.J).Z,b.top,b.left);return b.equals(a)}function qvc(a){var b=new kj;M(b,5,a.qb||!a.jb||yx(a.Wb)?1:2);M(b,6,!a.qb);M(b,11,Uva);return sj(qj(new pj,41),b).build()}function wvc(a,b){G.call(this,"cu");this.C=a;this.F=b}w(wvc,G);function Avc(a,b){G.call(this,"ce");this.C=a;this.F=b}w(Avc,G);function xvc(a,b){G.call(this,"cs");this.C=a;this.F=b}w(xvc,G);function Bvc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+Pr("Press enter to insert formula")+'"></span></div>');return V(a)};function yX(a,b){P.call(this);this.C=a;this.D=b}w(yX,P);p=yX.prototype;p.Ia=function(){this.Ma=T(Bvc,{name:this.C,title:this.D})};p.Wa=function(){yX.$.Wa.call(this);var a=this.cb("waffle-assistant-quicksum-entry-name");TW(a);this.getHandler().R(this.Ma,"keypress",this.j0b);O(this.Ma,!1)};p.getFunctionName=g("C");p.ib=function(a){mn(this.cb("waffle-assistant-quicksum-entry-value"),a||"");O(this.Ma,!!a)};p.mb=function(){return jp(this.Ma)};
p.j0b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new G("insert",this)))};function zX(a,b,c,d,e){P.call(this,e);this.Pa=a;this.Ga=b;this.L=c;this.Kb=d;this.D=a.C;this.Ja=new Rg;this.V=qj(new pj,17).build();this.O=qj(new pj,2).build();this.J=!1;this.F=[];this.C=null;this.H=[]}w(zX,P);
zX.prototype.Wa=function(){zX.$.Wa.call(this);this.Yh(new yX(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Yh(new yX(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Yh(new yX(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Yh(new yX(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Yh(new yX(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new fX(this.Ma,
this.Ga,this.D,this.L);this.C.hf(this.J);this.Ca(this.C);this.getHandler().R(this,"insert",this.Z).R(this.C,"formula_inserted",this.qa)};
function Cvc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(fw(a.D)){var c=gw(a.D),d=c.ck(),e=nD(a.D);if(sb(d,c.Kt,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=Sg(e+"",h.qc(),h.hc(),h.Kc(),h.Rc());c.push(a.Ja.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){O(a.Ma,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.od(0).ib(b(d.sum));a.od(1).ib(b(d.average));a.od(2).ib(b(d.min));a.od(3).ib(b(d.max));
1<e?a.od(4).ib(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):O(a.Ma,!1);if(a.C){a.C.J=[];a.H=[];for(d=0;d<a.hd();++d)e=a.od(d),a.H.push(Dvc(a,e.getFunctionName()));a.C.J=a.H}}else O(a.Ma,!1)}else O(a.Ma,!1)}else O(a.Ma,!1)}zX.prototype.hf=function(a){this.J=a;this.C&&this.C.hf(a);tq(this.Ma,"waffle-assistant-quicksum-panel-readonly",a)};
zX.prototype.Z=function(a){var b=a.target;a=this.F[0];a=new Ld(a.left,a.Kc());b=b.getFunctionName();b=Dvc(this,b);a=new mH(gw(this.D),a,b);this.L.C(a);this.Kb.fc(2624,this.O)};zX.prototype.qa=function(){this.Kb.fc(2624,this.V)};function Dvc(a,b){var c=Gw(a.Pa.L);a=pb(a.F,function(a){return zw(a)});return"="+b+"("+a.join(c)+")"};function Evc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(Ss({content:Lr("INSERT CHART"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(Ss({Ce:"waffle-autovis-lightbox-close",content:Mr(""+U(fu({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Lr("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
U(Ss({content:Mr("&#10094;"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Nr('aria-label="'+Pr("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(Ss({content:Mr("&#10095;"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Nr('aria-label="'+Pr("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.oLb)+"</div></div></div>");return V(a)}function Fvc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function AX(a,b,c,d){P.call(this,d);this.F=a;this.D=b;this.Kb=c;this.H=[];this.C=new Ts("",this.Ba());this.Xa(this.C);this.O=new Ts("",this.Ba());this.Xa(this.O);this.L=new Ts("",this.Ba());this.Xa(this.L);this.J=new Ts("",this.Ba());this.Xa(this.J)}w(AX,P);p=AX.prototype;p.Ia=function(){AX.$.Ia.call(this);this.Ma=T(Evc,{oLb:this.F.length})};
p.Wa=function(){AX.$.Wa.call(this);var a=S.KO.isEnabled();this.hf(!a);a=this.cb("waffle-autovis-lightbox-close");this.C.ob(a);a=this.cb("waffle-autovis-lightbox-insert");this.O.ob(a);var b=this.cb("waffle-autovis-lightbox-previous");this.L.ob(b);b=this.cb("waffle-autovis-lightbox-next");this.J.ob(b);Gvc(this);Hvc(this,this.D,!1);this.getHandler().R(document.body,Vba,this.dXb).R(this.Ma,"keydown",this.eXb).R(Um(),"resize",this.hXb).R(this.C,"action",this.close).R(this.O,"action",this.Bub).R(this.L,
"action",this.gXb).R(this.J,"action",this.fXb);b=new CI(this.Ma,this.Ba());DI(b);this.Ca(b);a.focus()};function Gvc(a){var b=a.cb("waffle-autovis-lightbox-content"),c=a.cb("waffle-autovis-lightbox-content-inner");a=a.cb("waffle-autovis-lightbox-page-count");var d=Sm();a=gp(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;dp(c,d,e);dp(b,d,e+a.height+35)}p.hf=function(a){tq(this.Ma,"waffle-autovis-lightbox-readonly",a)};
function Hvc(a,b,c){c&&Ao("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?Ivc(a,b):a.F[b]&&ysc(a.F[b],u(a.Bnb,a,b),!0)}p.Bnb=function(a,b){if(!this.isDisposed()&&b){var c=this.cb("waffle-autovis-lightbox-container"),d=T(Fvc);c.appendChild(d);this.H[a]=d;EV(b,d,this.Kb,Wn);Ivc(this,a)}};function Ivc(a,b){O(a.H[a.D],!1);O(a.H[b],!0);a.L.fb(!!b);a.J.fb(b!=a.F.length-1);var c=a.cb("waffle-autovis-lightbox-page-number");mn(c,b+1);a.D=b}p.dXb=function(a){!kn(this.Ma,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.eXb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?this.D&&Hvc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Jvc(this);a.stopPropagation()};p.hXb=function(){var a=this.cb("waffle-autovis-lightbox-container");$m(a);this.H=[];Gvc(this);Hvc(this,this.D,!0)};p.Bub=function(){this.close();Bsc(this.F[this.D],2256)};p.gXb=function(){this.D&&Hvc(this,this.D-1,!0);this.D||this.J.Ma.focus()};p.fXb=function(){Jvc(this);this.D==this.F.length-1&&this.L.Ma.focus()};
function Jvc(a){a.D!=a.F.length-1&&Hvc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.ld=function(){AX.$.ld.call(this);var a=this.F[this.D];a&&a.Ma&&a.Ma.focus()};function BX(a,b,c,d,e,f){zU.call(this,f);this.Ja=a;this.bd=b.C;this.xb=c;this.le=d;this.Kb=e;this.Za=new zX(b,c,d,e,this.Ba());this.Xa(this.Za);this.L=new $V(!1,"#4285f4");this.Xa(this.L);this.J=null;this.kc=this.Wb=!1;this.Mb=!0;this.Ib=pi();this.gb=this.bb="";this.Pa=qj(new pj,10).build()}w(BX,zU);p=BX.prototype;p.Ia=function(){BX.$.Ia.call(this);this.Ma=T(Kvc,{cUb:Tn})};
p.Wa=function(){BX.$.Wa.call(this);var a=this.cb("waffle-assistant-quicksum-panel");this.Za.ob(a);a=this.cb("waffle-assistant-spinner-container");this.L.render(a);this.getHandler().R(this,"close-sidebar",this.bpa).R(this.Ja,mvc.D1a,this.Toa).R(this.Ja,mvc.B1a,this.Soa).R(this.Ja,mvc.AZa,this.toa).R(this.Ja,mvc.zZa,this.qoa).R(this.cb("waffle-assistant-scroll-pane"),"scroll",Clc(this.gwa,10,this));a=S.KO.isEnabled();this.hf(!a)};
p.resize=function(){var a=this.cb("waffle-assistant-sidepane-content"),a=gp(a).height,b=this.cb("waffle-assistant-spinner-container");Mo(b,"margin-top",a/2-16+"px")};p.lh=ma;function Lvc(a,b){var c=Mvc(a);c.length&&(F(a.J),c=c.filter(function(a){return a instanceof XW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.J=new AX(c,b,a.Kb,a.Ba()),a.J.render(),a.Ca(a.J),a.J.hf(a.kc)))}p.hf=function(a){this.kc=a;tq(this.Ma,"waffle-assistant-readonly",a);this.Za.hf(a);this.J&&!this.J.isDisposed()&&this.J.hf(a)};
p.setVisible=function(a){var b=this.mb();BX.$.setVisible.call(this,a);if(a&&!b){var c=uvc(this.Ja,a);c?(b=new xrc,M(b,1,le(c,"r")),M(b,2,le(c,"c")),M(b,3,c.Jh()),c=new kj,cj(c,4,b),b=sj(tj(this.Pa),c).build()):b=this.Pa;this.gb=qi(this.Ib,ok.eya,!1,b);this.L.setActive(!0);CX(this)}a||Nvc(this,!0)};p.Toa=function(){this.mb()&&(Nvc(this,!0),this.L.setActive(!0),CX(this))};p.Soa=function(){this.mb()&&(this.L.setActive(!1),CX(this))};
p.toa=function(a){this.mb()&&(this.Kb.C(2775,this.Pa),Nvc(this,void 0,a.C,a.F),Ovc(this)||this.L.setActive(!0),CX(this),this.Mb=!1)};
p.qoa=function(a){if(this.mb()){this.Kb.C(2776,this.Pa);var b=a.F;0<b.length&&(this.bb=qi(this.Ib,ok.cya));Nvc(this,!1);this.L.setActive(!1);a=a.C;for(var c=0;c<b.length;c++){var d=xc(b[c],1);$n&&5==d&&(this.Z=B(b[c],12),this.V=B(b[c],4,0),this.qa=B(b[c],11),Pvc(this),2==this.Z&&(this.O=new DX(this.qb,this.xb,this.Jc,this.V,this.Z,this.qa),this.Xa(this.O,!0)))}for(c=0;c<this.D.length;c++){for(var d=[],e=0;e<b.length;e++){var f=xc(b[e],1);this.D[c].Via(f)&&d.push(b[e])}0<d.length?this.D[c].dwa(d,a):
this.D[c].dW(!0)}b=Mvc(this);0<b.length&&this.Wb&&(b[b.length-1].Ib=!0);this.Wb=!1;CX(this);Qvc(this);this.gwa()}};function CX(a){var b=Ovc(a),c=jp(a.cb("waffle-assistant-quicksum-panel")),d=a.L.Zb(),b=b||c||d;a=a.cb("waffle-assistant-empty-list");O(a,!b)}p.Cc=ma;p.cta=ma;p.ju=g("Kb");p.Fd=g("kc");p.bpa=ma;p.MJb=function(){""!=this.bb&&(ri(this.Ib,this.bb),this.bb="");""!=this.gb&&(ri(this.Ib,this.gb),this.gb="");this.Mb||(this.Kb.fc(2777,this.Pa),this.Mb=!0)};function Rvc(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+Svc()+"</div>");return V(a)}
function Tvc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+Svc()+"</div>")}function Svc(){var a=""+U(Ss({Ce:"waffle-assistant-formatting-edit-button",content:Lr("Edit"),style:4}));return V(a)};function Uvc(a,b,c){VW.call(this,a,c);a=pb(wc(this.D,7),Ulc);this.C=new CU(!1,a,7);this.Xa(this.C);this.J=new Ts("",this.Ba());this.Xa(this.J);this.Kb=b;this.H=!1;this.F=-1}w(Uvc,VW);var Vvc={Hfa:"waffle-assistant-banding-color-picker-container",Rfa:"waffle-assistant-formatting-edit-button",xJ:"waffle-assistant-banding-range"};p=Uvc.prototype;p.Ia=function(){Uvc.$.Ia.call(this);WW(this).appendChild(T(Rvc))};
p.Wa=function(){Uvc.$.Wa.call(this);this.getHandler().R(this.J,"action",this.frb).R(this.C,"banding-scheme-changed",this.jmb);this.Kb.C(2768)};p.yI=function(a){var b=this.cb(Vvc.Hfa);this.C.render(b);$lc(this.C);var b=this.cb(Vvc.xJ),c=B(this.D,4,0),d=Xg(c);mn(b,zw(d));Wvc(this,c);b=this.cb(Vvc.Rfa);this.J.ob(b);a()};p.sI=function(){mq(this.Ma,"Suggested alternating background colors");tr(this.C,"Choose a color scheme")};p.dG=n("assistantBandingFeedback");p.YL=n(2672);p.XL=n(2671);
p.frb=function(a){yo.dispatchEvent({type:"show-banding-pane-recommendation",GTa:this.D,j8a:amc(this.C)});a.stopPropagation()};p.jmb=function(a){if(!this.H&&DU(this.C)){var b=this.F;this.F=this.C.Kh();this.F==b?this.dispatchEvent(new QW("qe",this,2797)):this.dispatchEvent(new QW("ke",this,2673));a.stopPropagation()}};
function Wvc(a,b){a.H=!0;var c=b.Jb();b=Xg(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.qc(),b.hc(),b.Kc(),b.Rc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new Rg).cd(Ce.Ra(),c),c=Ulc(c)):c=null;c?(c=bmc(a.C,c),cK(a.C,c?c.getElement():null)):cK(a.C,null);a.F=a.C.Kh();a.H=!1};function Xvc(a,b){VW.call(this,a,b);this.C=new Ts("",this.Ba());this.Xa(this.C);this.qb=wc(a,6)}w(Xvc,VW);var EX={Rfa:"waffle-assistant-formatting-edit-button",D0a:"waffle-assistant-conditionalformat-format-preview",Z2a:"waffle-assistant-conditionalformat-rule-holder",h5:"waffle-assistant-conditionalformat-description",e2a:"one-rule",$3a:"two-rules",N3a:"three-rules",x2a:"waffle-assistant-conditionalformat-format-preview-label"};p=Xvc.prototype;p.Ia=function(){Xvc.$.Ia.call(this);WW(this).appendChild(T(Tvc))};
p.Wa=function(){Xvc.$.Wa.call(this);var a=this.cb(EX.Rfa);this.C.ob(a);TW(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.Glb)};p.yI=function(a){mn(this.cb(EX.h5),xc(this.D,3));var b=this.cb(EX.Z2a),c=new Yvc(this,this.Ba());this.Xa(c);c.ob(b);TW(b,"Apply conditional format rules");a()};p.sI=ma;p.dG=n("assistantConditionalFormatFeedback");p.YL=n(2630);p.XL=n(2629);
p.Glb=function(){this.dispatchEvent(new QW("le",this,2563));this.dispatchEvent(new QW("ne",this,2670,void 0,void 0,Xg(B(this.qb[0],1,0))));Co()};function Yvc(a,b){qr.call(this,void 0,void 0,b);this.C=a}w(Yvc,qr);
Yvc.prototype.$d=function(a){Yvc.$.$d.call(this,a);var b=this.C.qb;switch(b.length){case 0:break;case 1:var c=EX.e2a;break;case 2:case 4:c=EX.$3a;break;default:c=EX.N3a}for(var d=0;d<b.length;d++){var e=b[d],f=Vm("DIV");qq(f,[EX.D0a,c]);var h=Vm("DIV");pq(h,EX.x2a);f.appendChild(h);mn(h,"123");if(rc(e,2)){var k=B(B(e,2),1);switch(B(B(k,1),1)){case 9:case 13:var k=wc(B(k,1),2)[0],l=wc(e,1)[0];mn(h,eA(k,xc(l,1),xc(l,2),xc(l,4)))}}glc(e,f);a.appendChild(f)}};
Yvc.prototype.Di=function(){var a=this.C;a.dispatchEvent(new QW("le",a,2563));return!0};function Zvc(a,b,c){aX.call(this,2,b,a,c)}w(Zvc,aX);p=Zvc.prototype;p.D4=n("Formatting");p.Via=function(a){return 2==a||4==a};p.e8=function(a){var b=B(a,1);switch(b){case 2:return new Xvc(a,this.Ba());case 4:return a=new Uvc(a,this.ju(),this.Ba()),this.getHandler().R(a,"ke",this.gUb).R(a,"qe",this.OGb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.gUb=function(a){hX(this.bb,"Alternating colors applied",this.Ba(),u(this.lmb,this,a.C))};p.OGb=function(){this.bb.clear()};
p.lmb=function(a){this.dispatchEvent(new QW("ve",a,2796))};p.hf=function(a){Zvc.$.hf.call(this,a);this.setVisible(!a)};p.fwa=function(a){return this.Fd()?(this.setVisible(!1),a):Zvc.$.fwa.call(this,a)};p.ewa=n(3);function FX(a,b,c,d,e){P.call(this);this.J=a;this.Pa=b;this.Z=c;this.D=d;this.H=e}ga(FX,P);FX.prototype.getTableRange=g("Z");FX.prototype.Rda=function(a,b){this.Z=a;this.D=b};FX.prototype.Wa=function(){P.prototype.Wa.call(this);this.getHandler().R(this.J.C,"M",this.Sa)};FX.prototype.Sa=function(){this.Pa.Dc()};function $vc(a,b,c){var d=a.Kc(),e=a.Rc();switch(b){case 0:d=Math.min(d,a.qc()+c);break;case 1:e=Math.min(e,a.hc()+c)}return Sg(a.Jb(),a.qc(),a.hc(),d,e)};function awc(a,b){E.call(this);this.F=a;this.H=b;this.C=new vtc(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.Ca(this.C);this.D=new vtc(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.Ca(this.D)}ga(awc,E);awc.prototype.Ka=function(){eX(this.C);eX(this.D);E.prototype.Ka.call(this)};
function bwc(a,b,c,d,e,f){lAb(b);var h=Xg(d),h=new Zd(h.qc(),h.hc(),Math.min(h.Kc(),h.qc()+6),Math.min(h.Rc(),h.hc()+3)),k=V8a(b),l=Hz(a.F).Xd(),m=l.eg(new Pd(h.qc(),h.Kc()),"r",!1,!1,!0,!0)-1,l=l.eg(new Pd(h.hc(),h.Rc()),"c",!1,!1,!0,!0)-1,m=Math.min(115,m),l=Math.min(c.offsetWidth-2,l);mAb(b,k,l,m);c=$vc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.qc();k=d.hc();switch(e){case 0:h=Math.min(d.Kc(),d.qc()+f);break;case 1:k=Math.min(d.Rc(),d.hc()+f)}d=Sg(d.Jb(),h,k,d.Kc(),d.Rc());dX(b,uT(d));dX(a.D,uT(c))};function cwc(a){var b=a.XSa,c=a.vRa,d=a.gDa;return V('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+U(a.YSa)+'</div></div><div class="waffle-tables-popup-content">'+U(b)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+U(c)+
'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+U(d)+"</div></div></div></div>")}
function dwc(){var a=Lr("Edit data range");var b=""+('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper">Data Range'+U(cmc({lba:!0}))+'</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');b=V(b);a=""+cwc({YSa:a,XSa:Mr(""+b),vRa:Lr("Update"),gDa:Lr("Cancel")});
return V(a)}function ewc(){var a=""+cwc({YSa:Lr("Improve suggestions"),XSa:Mr('<div class="waffle-tables-popup-header-message"></div>'),vRa:Lr("No"),gDa:Lr("Yes")});return V(a)}function fwc(a){a='For <span class="waffle-assistant-table-bar-range">'+(U(a.JVb)+"</span>");return V(""+a)}function gwc(a){a='Is <span class="waffle-assistant-table-first-header">'+(U(a.LGb)+"</span> a header row, containing titles that describe the columns below?");return V(""+a)};function DX(a,b,c,d,e,f){FX.call(this,a,S.mY,d,e,f);this.C=(new ZP).build();this.Ca(this.C);this.L=new Ls("",new SW,this.Ba());this.Xa(this.L);Ku(this.C,this.L,S.V6);this.F=new Ls("",new SW,this.Ba());this.Xa(this.F);Ku(this.C,this.F,S.mY);this.V=new awc(b,c);this.Ca(this.V);this.O=new ou(this);this.Ca(this.O)}ga(DX,FX);DX.prototype.Ia=function(){this.Ma=T(ewc)};
DX.prototype.Wa=function(){FX.prototype.Wa.call(this);this.L.ob(this.cb("waffle-tables-popup-done"));this.F.ob(this.cb("waffle-tables-popup-cancel"));var a=$vc(this.getTableRange(),this.H,1),a=zw(Xg(a)),a=T(gwc,{LGb:a});this.cb("waffle-tables-popup-header-message").appendChild(a);this.O.subscribe(S.V6,"action",this.Ga).subscribe(S.mY,"action",this.qa);var a=this.cb("waffle-assistant-table-canvas"),b=this.cb("waffle-assistant-canvas-container");bwc(this.V,a,b,this.getTableRange(),this.H,this.D)};
DX.prototype.qa=function(){this.dispatchEvent("te")};DX.prototype.Ga=function(){var a=Xg(this.getTableRange());switch(this.H){case 0:a=qda(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=qda(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=zw(a);this.dispatchEvent(new Yrc(a,this.D-1,this.H));this.dispatchEvent("te")};function hwc(a,b,c,d,e,f,h){FX.call(this,a,S.iQ,d,e,f);this.Za=b;this.Ja=d;this.bb=e;a=Xg(d);this.F=zw(a);this.Ga=new awc(b,c);this.Ca(this.Ga);this.C=null;this.Kb=h;this.L=(new ZP).build();this.Ca(this.L);this.V=new Ls("",new SW,this.Ba());this.Xa(this.V);Ku(this.L,this.V,S.lY);this.O=new Ls("",new SW,this.Ba());this.Xa(this.O);Ku(this.L,this.O,S.iQ);this.qa=new ou(this);this.Ca(this.qa)}ga(hwc,FX);p=hwc.prototype;p.Ia=function(){this.Ma=T(dwc)};
p.Wa=function(){FX.prototype.Wa.call(this);this.V.ob(this.cb("waffle-tables-popup-done"));this.O.ob(this.cb("waffle-tables-popup-cancel"));var a=this.cb("waffle-range-selection-input");a.focus();this.getHandler().R(this.Ma,"keydown",this.cKb).R(a,"keyup",this.dKb).R(a,Wba,this.pEb).R(this.Za,"selectionChange",this.eKb);this.qa.subscribe(S.lY,"action",this.fKb).subscribe(S.iQ,"action",this.Jmb);QE(this.J,"selection-input");iwc(this)};p.Ka=function(){QE(this.J,"normal");FX.prototype.Ka.call(this)};
function jwc(a){var b=a.cb("waffle-assistant-table-canvas"),c=a.cb("waffle-assistant-canvas-container");bwc(a.Ga,b,c,a.getTableRange(),a.H,a.D)}p.Jmb=function(){this.dispatchEvent("te")};p.fKb=function(){var a=this.bb!=this.D,b=!Alc(this.Ja,this.getTableRange());if(a||b)a&&this.Kb.fc(35506),b&&this.Kb.fc(35507),this.dispatchEvent(new Yrc(this.F,this.D,this.H));this.dispatchEvent("te")};function iwc(a){var b=a.cb("waffle-range-selection-input"),c=Xg(a.Ja);a.F=zw(c);b.value=a.F;kwc(a);jwc(a)}
p.Rda=function(a,b){FX.prototype.Rda.call(this,a,b);jwc(this)};function lwc(a){var b=gw(a.J.C),c=b.vc();if(b=zLa(a.F,b))c=Vg(b,c),a.Rda(c,mwc(a,c)),kwc(a)}function mwc(a,b){b=nwc(b);return a.D>b?b:a.D}function nwc(a){var b=xc(a,2);a=a.Kc();return Math.min(a-b-1,3)}
function kwc(a){F(a.C);a.C=new uJ;a.Xa(a.C);Ku(a.L,a.C,S.lha);ET(a.C,FU.getInstance());a.C.render(a.cb("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.vtb);for(var b=nwc(a.getTableRange()),c=0;c<=b;c++){var d=(new Ko("{NUM_ROWS, plural,=0 {none}=1 {1 row}other {# rows}}")).format({NUM_ROWS:c});a.C.qe(new tt(d))}a.C.Vf(a.D)}p.pEb=function(){var a=this.cb("waffle-range-selection-input");this.F!==a.value&&(this.F=a.value,lwc(this))};
p.eKb=function(a){var b=a.rect;!b||a.V||ge(b)||(this.F=a=zw(b),b=this.cb("waffle-range-selection-input"),b.value=a,b.select(),lwc(this))};p.cKb=function(a){var b=this.cb("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;lwc(this);S.lY.Dc();break;case 27:a.stopPropagation(),a.preventDefault(),iwc(this),S.iQ.Dc()}};p.dKb=function(){this.F=this.cb("waffle-range-selection-input").value;lwc(this)};
p.vtb=function(){var a=this.C.Kh();this.Rda(this.getTableRange(),a)};function GX(a,b,c,d){ku.call(this,a,b,c,d,void 0,void 0,!0)}w(GX,ku);GX.prototype.Ia=function(){GX.$.Ia.call(this);pq(this.Ma,"waffle-assistant-toast");pq(this.cb("docs-ui-toast-content"),"waffle-assistant-toast-content")};GX.prototype.cF=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=up(this,b);GX.$.cF.call(this,a,b,c)};GX.prototype.Xh=function(a,b,c,d){this.cF(a,b,d);a=wp(this,b);Bi(this.getHandler(),a,Zc,u(function(){this.setVisible(!1);c()},this))};function owc(){this.C=null}w(owc,E);owc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function hX(a,b,c,d){a.clear();a.C=new GX(b,c,!1,5E3);a.C.render();d&&a.C.Xh("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}owc.prototype.Ka=function(){owc.$.Ka.call(this);this.clear()};function Kvc(a){a=a||{};var b=V,c=Mr('<div class="waffle-assistant-replaceable-title">'+pwc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(Lsc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.cUb?e+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=V(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=V(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(U(EU(Kr({title:c,$k:Mr(""+d),id:Lr("autovis"),N3:Lr("waffle-assistant-sidepanel"),oea:Lr("waffle-assistant-title"),JZ:Lr("waffle-assistant-sidepane-content")},a))))}
function pwc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(Lsc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function HX(a,b,c,d,e,f,h,k){BX.call(this,a,b,c,d,e,k);this.Yd=f;this.qb=b;this.Sa=new P(this.Ba());this.Xa(this.Sa);this.Ga=new owc;this.Ca(this.Ga);this.D=[];this.F=null;this.jb=new Ts("",k,4);xr(this.jb,2,!1);this.Xa(this.jb);this.Jc=h;this.V=null;this.Z=0;this.qa=null;this.Qb=new Ls("",new SW,this.Ba());this.Xa(this.Qb);this.Vb=new P(this.Ba());this.Xa(this.Vb);this.zc=(new ZP).build();this.Ca(this.zc);Ku(this.zc,this.Qb,S.U6);this.O=this.H=null}w(HX,BX);
var IX={jE:"waffle-assistant-scroll-pane-feature-content",gac:"waffle-assistant-empty-list",n0a:"waffle-assistant-features",s1a:"waffle-assistant-empty-list-learn-more",Jga:"waffle-assistant-expanded-panel",hAa:"waffle-assistant-replaceable-title",Iuc:"waffle-assistant-scroll-pane",I3a:"waffle-assistant-sidepane-tables-range",J3a:"waffle-sidebar-tables-bar",K3a:"waffle-assistant-tables-edit-range-button",jQ:"waffle-assistant-title"},qwc={defaultHelpArticleId:"6280499"};p=HX.prototype;
p.Wa=function(){var a=this;HX.$.Wa.call(this);this.Sa.ob(this.cb(IX.Jga));TW(this.C.Ma,"Close");$n&&(this.Vb.ob(this.cb(IX.I3a)),Pvc(this),this.Qb.ob(this.cb(IX.K3a)));var b=this.qb.L.Ps();Tn&&(Qva||"en"==PE(b))&&(b=new xX(this.Yd,this.xb,this.bd,this.le,this.ju(),this.Ga,this.qb,this.Ba()),this.Xa(b),this.D.push(b));b=new Zvc(this.ju(),this.Ga,this.Ba());this.Xa(b);this.D.push(b);b=new bX(this.bd,this.xb,this.ju(),this.Ga,this.Ba());this.Xa(b);this.D.push(b);var c=this.cb(IX.n0a);z(this.D,function(b){b.render(c);
a.Sa.Xa(b.C,!0)});this.jb.ob(this.cb(IX.s1a));this.getHandler().R(this.jb,"action",this.K0b).R(this,"te",this.GDa);rwc(this)};p.K0b=function(){Q.Go.Dc(qwc)};function Qvc(a){z(a.D,function(a){Usc(a)})}function Nvc(a,b,c,d){z(a.D,function(a){a.dW(b,c,d)})}function Ovc(a){return!!ub(a.D,function(a){return a.npa()})}
p.gwa=function(){var a=this,b=this.cb("waffle-assistant-scroll-pane").scrollTop+gp(this.cb("waffle-assistant-sidepane-content")).height;z(this.D,function(c){a.F&&a.F!=c||(c instanceof bX&&a.getHandler().Ic(c,"oe",a.MJb),b=c.fwa(b))})};function Mvc(a){if(a.F)return a.F.C.C;var b=[];z(a.D,function(a){Ib(b,Tsc(a))});return b}p.hf=function(a){HX.$.hf.call(this,a);rwc(this)};p.lh=function(a){z(this.D,function(b){b.lh(a)})};p.cta=function(){var a=this.cb(IX.hAa),b=this.cb(IX.jQ);fp(b,gp(a).height)};
p.Cc=function(){var a=this,b=this.cb(IX.jE),c=this.cb(IX.hAa),d=this.Sa.Ma;if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,O(b,!0),O(d,!1),dr(c,pwc),kq(c,"label"),this.resize();else if(this.F=ub(this.D,function(a){return a.Zb()}))O(b,!1),O(d,!0),this.F.C.setVisible(!0),Vsc(this.F,c),mq(c,this.F.D4());this.cta();b=new Cl(function(){var b=Ev;b&&b.dispatchEvent("resize");a.gwa()},300);this.Ca(b);b.start()};
p.setVisible=function(a){var b=this.mb();HX.$.setVisible.call(this,a);a&&!b&&swc(this,!0);a||this.Ga.clear()};p.bpa=function(){HX.$.bpa.call(this);this.F&&this.Cc();this.GDa()};p.Toa=function(){HX.$.Toa.call(this);swc(this,!0)};p.Soa=function(){HX.$.Soa.call(this);swc(this,!1)};p.toa=function(a){HX.$.toa.call(this,a);swc(this,!0,a.C)};p.qoa=function(a){HX.$.qoa.call(this,a);swc(this,!1)};
function twc(a,b){b?(UZb(a.H),a.H=new hwc(a.qb,a.xb,a.Jc,a.V,a.Z,a.qa,a.ju()),a.Xa(a.H),a.H.render(a.getElement())):a.H&&(a.removeChild(a.H,!0),F(a.H),a.H=null);(a=uwc(a))&&ivc(a,b)}function rwc(a){z(a.D,function(b){b.hf(a.Fd())})}function uwc(a){return(a=ub(a.D,function(a){return a instanceof xX}))?a:null}function swc(a,b,c){z(a.D,function(a){c||Psc(a.C,b)});$n&&(b&&(a.V=null,a.Z=0,a.qa=null),Pvc(a))}
function Pvc(a){var b=a.cb(IX.J3a),c="";a.V&&0==a.qa?(c=Xg(a.V),c=zw(c),O(b,!0)):O(b,!1);b=T(fwc,{JVb:c});a=a.Vb.$b();$m(a);a.appendChild(b)}p.GDa=function(){twc(this,!1);this.O&&(this.removeChild(this.O,!0),F(this.O));this.O=null;var a=uwc(this);a&&ivc(a,!1)};function vwc(a,b,c,d,e,f,h,k,l,m,q,r){var v=this;AU.call(this,b,h);this.Z=a;this.C=b;this.O=c;this.Ja=d;this.bb=e;this.L=f;this.J=c.C;this.Pa=this.Ga=!1;this.Kb=l;this.Za=r;this.Ee=new Rg;this.F=null;wwc(this);S.V4.fb(!0);a=new Bma;M(a,6,xwc());b=new hj;cj(b,58,a);this.H=qj(rj(new pj,b),10).build();this.Sa=pi();this.qa=qi(this.Sa,ok.bya);a=new Cl(function(){return ywc(v,!1)},100);this.Ca(a);a.start()}w(vwc,AU);
function wwc(a){var b=ew(a.bb);a.Kf().R(a.Ja,"selectionChange",a.P0b).R(a.J,"M",a.N0b).R(b,"ea",a.Kwb).R(a.C,"le",a.Ilb).R(a.C,"ke",a.Hlb).R(a.C,"qe",a.PAb).R(a.C,"ne",a.cnb).R(a.C,"pe",a.O0b).R(a.C,"ue",a.EDb).R(a.C,"re",a.qCb).R(a.C,"me",a.emb).R(a.C,"ve",a.Q0b).R(a.Z,"cu",a.Cob).R(a.C,"se",a.uCb);pu(a.V,S.KO,Gp,a.Eub).subscribe(S.LO,"action",a.bmb).subscribe(S.W4,"action",a.pDb).subscribe(S.ofa,"action",a.nSa).subscribe(S.Dy,"action",a.pyb).subscribe(S.U6,"action",a.ADb)}p=vwc.prototype;p.Gh=function(){return S.pfa};
p.Sv=function(){return S.Rwa};p.Xu=function(a){vwc.$.Xu.call(this,a);S.W4.fb(a);ywc(this,!1);!this.Ga&&a&&(this.Ga=!0);hq(this.Za,{Lb:a})};p.d1=function(a){var b=this;this.C.cta();var c=new Cl(function(){vwc.$.d1.call(b,a)},300);this.Ca(c);c.start()};p.lh=function(a){this.C.lh(a);this.Z.lh(a)};p.bmb=function(){var a=this.C.mb();this.Gh().setVisible(!a);a?this.Kb.fc(2226,this.H):(this.C.focus(),this.Kb.fc(2253,this.H))};p.nSa=function(){this.C.mb()||this.Xu(!0)};
p.pyb=function(){var a=uwc(this.C);a&&!a.Zb()&&(this.nSa(),kvc(a,"",!0))};p.pDb=function(a){Lvc(this.C,a)};p.ADb=function(){twc(this.C,!0)};p.P0b=function(){ywc(this,!0)};function ywc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.F&&c[0].equals(a.F)){a.F=null;return}}var d=a.C;d.mb()&&(Cvc(d.Za),CX(d));a.Z.update(!b,a.C.mb(),c)}
p.Cob=function(a){""!=this.qa&&(ri(this.Sa,this.qa),this.qa="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.Jh()>=Kva&&le(c,"r")>=Mva&&le(c,"c")>=Nva&&c.Jh()<=Lva)&&.6<=b;d!==this.Pa&&(this.Pa=d,S.V4.Dc(d));c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.Jh(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.Xc,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.mb()&&!this.Ga&&c&&d&&!yx(this.O),a=Bva&&a,d=Cva&&this.O.Fd(),c&&(a||d)&&(c=new Bma,M(c,1,b),M(c,2,a),M(c,3,d),M(c,5,
Rva),M(c,6,xwc()),b=new hj,cj(b,58,c),b=rj(qj(new pj,10),b).build(),this.JCa(b)))};p.JCa=function(a){var b=this;this.C.Wb=!0;var c=sYa(gw(this.J));if(!EXb.C&&!c){var d=a||this.H;this.Gh().setVisible(!0);this.Kb.fc(2225,d);this.Kb.fc(2253,this.H);a=new Cl(function(){b.C.mb()||b.Kb.fc(2752,d)},5E3);this.Ca(a);a.start()}};function xwc(){switch(Ova){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.emb=function(){this.C.Cc()};
p.Q0b=function(a){var b=a.C,c=B(b.D,4,0),d=parseInt(c.Jb(),10);this.F=Xg(c);this.L.C(new wYb(d));Wvc(b,c);this.Kb.fc(a.xk(),this.H)};p.N0b=function(){fw(this.J)?(this.C.fb(!0),ywc(this,!1)):(this.Gh().setVisible(!1),this.C.fb(!1))};p.Eub=function(){this.C.hf(!S.KO.isEnabled())};p.Kwb=function(a){ywc(this,!1,OKa(a))};
p.Ilb=function(a){var b=gw(this.J),c=""+b.vc(),d=[],e=hlc(b);if(e){var b=new Wf,f=xc(e,2);D(b,3,f);f=xc(e,2);D(b,2,f);e=xc(e,1);D(b,1,e);d.push(b)}b=a.C.qb;for(e=0;e<b.length;e++)f=new Wf,D(f,2,b[e]),d.push(f);this.L.C(new NV(d,c));this.Kb.C(a.xk(),this.H)};
p.Hlb=function(a){var b=a.C,c=amc(b.C),d=B(b.D,4,0),e=c.Yu?c.Fx:null,f=c.C?c.kx:null,h=parseInt(d.Jb(),10),k=zwc(d);this.F=Xg(d);k?this.L.C(new yU(k,h,this.F,e,c.Is,c.Et,f)):this.L.C(new wU(h,this.F,e,c.Is,c.Et,f));d=new xlc;M(d,1,1);c=new FT;b=B(b.D,2);M(c,2,b);cj(c,5,d);b=new hj;cj(b,46,c);b=rj(qj(new pj,10),b).build();this.Kb.C(a.xk(),b)};p.PAb=function(a){a=a.C;var b=B(a.D,4,0),c=parseInt(b.Jb(),10),d=zwc(b);this.F=Xg(b);this.L.C(new xU(d,c));Wvc(a,b)};
p.uCb=function(a){var b=gw(this.O.C),c=b.vc(),b=Vg(zLa(a.J,b),c);a=$vc(b,a.V,a.L);c=this.Z;nvc(c);pvc(c,!0,!0,b,a)};function zwc(a){var b=a.Jb();a=Xg(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.qc(),a.hc(),a.Kc(),a.Rc(),7,!1);return 0<b.length?b[0]:null}p.cnb=function(a){dC(gw(this.J),a.F);this.Kb.C(a.xk(),this.H)};
p.EDb=function(a){var b=a.C;a=a.xk();if(b instanceof gX||b instanceof jX)this.Kb.C(a,this.H);else{var c=Mvc(this.C),d=new FT,e=B(b.D,2),c=c.indexOf(b);M(d,1,c);M(d,2,e);e=new hj;cj(e,46,d);if(b instanceof XW){(d=b.H)?(b=Awc(this,b,d),b=Coc(b,d,d.tf())):b=null;if(!b)return;cj(e,39,b)}else if(b instanceof ZW){var f=b.D,c=new Grc;if(b instanceof ZW)b=1;else throw Error("Unknown text analysis card type.");f=wc(B(f,8),20).slice(0,10);M(c,2,f||[]);M(c,1,b);cj(d,3,c)}e=rj(qj(new pj,10),e).build();this.Kb.C(a,
e)}};p.qCb=function(){this.C.Cc()};
p.O0b=function(a){var b=a.J;if(b){var c=gw(this.J),d=a.Te();d||(d=Hz(this.Ja).kd().C.Te());var e=16,f=16,h=a.Sa;h&&(e=h.x,f=h.y);h=H4a(this.O.J);c={oid:null,ar:kC(c,d.y),ac:lC(c,d.x),x:e,y:f,h:rC.height,w:rC.width,p:{context:{chartName:"Chart "+(h+1)}}};c=new EE(aw(this.J)||0,c,!1,!1);d=b.tf();e=new Vl(d);f=em(e,"headers");f=null!=f&&va(f)&&Oa(f)?parseInt(f,10):-1;c.bb=f;c.Z=0;f="1"==em(e,"transpose");c.Sa=f;c.L=f?"ROWS":"COLS";f=em(e,"range");f=llc(XT(f,","),this.J);c.bI(f);zT(c,b);(e=em(e,"dt"))&&
s4a(c,this.Ee.cd(hg.Ra(),JSON.parse(decodeURIComponent(e))));this.Ja.dispatchEvent(new VE("objectRequest"));this.L.C(new kH(this.O,c));e=Bwc(this,b,a.L,a.Qd());e.Vk(c.getId()||0);AV(this.Kb,a.xk(),e,10,b,d)}};function Awc(a,b,c){var d=Mvc(a.C).filter(function(a){return a instanceof XW});return Bwc(a,c,d.indexOf(b),b.H&&b.H.Qd())}
function Bwc(a,b,c,d){var e=new zV;a=Mvc(a.C).filter(function(a){return a instanceof XW}).map(function(a){return a.getChartType()});e.O=a;e.H=c;zoc(e,b.getChartType());e.F=d?d.clone():null;return e};function Cwc(){E.call(this)}w(Cwc,io);Cwc.prototype.C=function(){return lvc};Cwc.prototype.F=function(){return HX};Cwc.prototype.D=function(){return vwc};vo("assistant",Cwc);
